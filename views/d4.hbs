<!-- Flexbox container for aligning the toasts -->
<div aria-live="polite" aria-atomic="true" class="position-fixed p-4" style="z-index: 100; top: 50px; left:-260px" id="toastWrap">
  <!-- Then put toasts within -->
    <div role="alert"
         data-delay="2000" 
         aria-atomic="true"
         aria-live="assertive"
         id="toastRecord_Success"
         class="toast shadow-lg bg-light">
        <div class="toast-header text-white bg-success">
            <strong class="mr-auto">Сохранено</strong>
            <small></small>
            <button type="button" 
                    class="ml-2 mt-1 mb-1 close" 
                    data-dismiss="toast" 
                    aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="toast-body">
            Запись сохранена успешно
        </div>
    </div>

    <div role="alert"
         data-delay="2000" 
         aria-atomic="true"
         aria-live="assertive" 
         id="toastRecord_Error"
         class="toast shadow-lg bg-light">
        <div class="toast-header text-white bg-danger">
            <strong class="mr-auto">Ошибка</strong>
            <small></small>
            <button type="button" class="ml-2 mt-1 mb-1 close" data-dismiss="toast" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="toast-body">
            Запись не была сохранена
        </div>
    </div>
    <div class="toast shadow-lg bg-light" role="alert" aria-live="assertive" aria-atomic="true" data-delay="700" id="toastRecordSave_Success">
        <div class="toast-header text-white bg-success">
            <strong class="mr-auto">Сохранено</strong>
            <small></small>
            <button type="button" class="ml-2 mt-1 mb-1 close" data-dismiss="toast" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="toast-body">
            Запись сохранена успешно
        </div>
    </div>
</div>


<div class="container-fluid" 
     style="padding-top: 60px;"
     data-ng-init="talonAmbCtr.init()"
     data-ng-controller="TalonAmbController as talonAmbCtr">

    <!-- Удалить случай -->
    <div class="modal" tabindex="-1" role="dialog" id="dontDeleteSL_Modal">
        <div class="modal-dialog" role="document">
            <div class="modal-content border-danger">
                <div class="modal-header border-danger bg-danger">
                    <strong>Внимание!</strong>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body text-center py-3">
                    <div class="row pt-3">
                        <div class="col-12">
                            Вы точно хотите удалить случай?
                        </div>
                    </div>
                </div>
                <div class="modal-footer text-center">
                    <button type="button"
                            data-dismiss="modal"
                            class="btn btn-secondary col-6">
                               Отмена 
                    </button>
                    <button type="button"
                            data-dismiss="modal"
                            data-ng-click="talonAmbCtr.delSL()"
                            class="btn btn-block btn-danger col-6">
                        Удалить случай
                    </button>
                    
                </div>
            </div>
        </div>
    </div>
    <!-- Удалить случай -->

    <!-- Счет не выбран -->
    <div class="modal" tabindex="-1" role="dialog" id="dontFindCheck_Modal">
        <div class="modal-dialog" role="document">
            <div class="modal-content border-warning">
                <div class="modal-header border-warning bg-warning">
                    <strong>Внимание</strong>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body text-center py-3">
                    <div class="row pt-3">
                        <div class="col-12">
                            Для загрузки списка талонов необходимо выбрать счет!
                        </div>
                    </div>
                </div>
                <div class="modal-footer text-center">
                    <button type="button"
                            data-dismiss="modal"
                            class="btn btn-secondary">
                               Отмена 
                    </button>
                    
                </div>
            </div>
        </div>
    </div>
    <!-- Счет не выбран -->

    <!-- Предупреждение -->
    <div class="modal" tabindex="-1" role="dialog" id="exportXMLAlert_Modal">
        <div class="modal-dialog" role="document">
            <div class="modal-content border-danger">
                <div class="modal-header border-danger bg-danger">
                    <strong>Внимание</strong>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Я подтверждаю, что согласен (-а) на выгрузку указанной информации 
                    и прикрепленных файлов (счетов) для дальнейшей отправки в ТФОМС. 
                    Я уведомлен о персональной ответственности за правильность, полноту 
                    и достоверность введенных данных, в соответствии с законодательством 
                    Российской Федерации.
                </div>
                <div class="modal-footer text-center">
                    <button type="button"
                            data-dismiss="modal"
                            class="btn btn-secondary">
                               Согласен 
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- Предупреждение -->

    <!-- Консилиум -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="consiliumEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Консилиум</strong>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="consiliumEditor_Tabs">
                        
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link active"
                               href="#consiliumEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link "
                               href="#consiliumEditor_Tab_List">
                                Список
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].cons.length}]}
                                </span>
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content" id="consiliumEditor_TabsContent">
                        <div class="tab-pane fade" id="consiliumEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].cons.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список консилиумов пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4 pt-4">
                                <div class="col-12 pb-4">
                                    <div class="row px-4 pt-2"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].cons.length"
                                         data-ng-repeat="consilium in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].cons">
                                         <div class="col-12">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.consiliumEditor.toEditor(consilium._id)">
                                                 Консилиум № {[{$index+ 1}]} ( от {[{consilium.dt_cons}]} ) 
                                            </a>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="consiliumEditor_Tab_Editor">
                            <div class="row pt-4">
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Дата проведения</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.consiliumEditorModel.dt_cons">
                                </div>
                            </div>
                            <div class="row pt-2">
                                <div class="col-12 pt-2 pb-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Цель проведения</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.consiliumEditorModel.pr_cons">
                                        <option data-ng-value="N019.ID_CONS"
                                                data-ng-repeat="N019 in talonAmbCtr.refBooks.N019">
                                            {[{N019.CONS_NAME}]}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.consiliumEditor.new()">Новый</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.consiliumEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.consiliumEditor.push()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Консилиум -->

    <!-- Направление -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="orderEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Направление</strong>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="orderEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link active"
                               href="#orderEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link"
                               href="#orderEditor_Tab_List">
                                Список
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].napr.length}]}
                                </span>
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content" id="orderEditor_TabsContent">
                        <div class="tab-pane fade" id="orderEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].napr.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список направлений пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4 pt-4">
                                <div class="col-12 pb-4">
                                    <div class="row px-4 py-2"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].napr.length"
                                         data-ng-repeat="order in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].napr">
                                         <div class="col-12">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.orderEditor.toEditor(order._id)">
                                               Направление № {[{$index+ 1}]} ( от {[{order.napr_date}]} )
                                                <!-- {[{order.napr_date}]} -->
                                            </a>
                                            
                                        </div>
                                        <!-- <div class="col-3">
                                            {[{order.napr_v}]}
                                        </div> -->
                                        
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click_="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="orderEditor_Tab_Editor">
                            <div class="row pt-4 pb-2">
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Дата проведения</label>
                                    <input type="text"
                                           class="form-control"
                                           placeholder="ДД.ММ.ГГГГ"
                                           data-ng-pattern_="/^\d{2}\.\d{2}\.\d{4}$/"
                                           data-ng-model="talonAmbCtr.orderEditorModel.napr_date">
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Код МО</label>
                                    <input type="text"
                                           class="form-control"
                                           title="Код МО, куда оформлено направление"
                                           placeholder="Код МО, куда оформлено направление"
                                           data-ng-model="talonAmbCtr.orderEditorModel.napr_mo">
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Вид направления</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.orderEditorModel.napr_v">
                                        <option value="1">Направление к онкологу</option>
                                        <option value="2">Направление на биопсию</option>
                                        <option value="3">Направление на дообследование</option>
                                        <option value="4" selected>Направление для определения тактики обследования и/или тактики лечения</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row pt-2 pb-4">
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Метод диагностического исследования</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.orderEditorModel.met_issl">
                                        <option value="">Нет</option>
                                        <option value="1">Лабораторная диагностика</option>
                                        <option value="2">Инструментальная диагностика</option>
                                        <option value="3">Методы лучевой диагностики, за исключением дорогостоящих</option>
                                        <option value="4">Дорогостоящие методы лучевой диагностики (КТ, МРТ, ангиография)</option>
                                    </select>
                                </div>
                                <div class="col-8">
                                    <label class="col-12 px-0 m-0 text-truncate">Медицинская услуга (код), указанная в направлении</label>
                                    <input type="text"
                                           class="form-control"
                                           title="Медицинская услуга (код), указанная в направлении"
                                           placeholder="Медицинская услуга (код), указанная в направлении"
                                           data-ng-model="talonAmbCtr.orderEditorModel.napr_usl">
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.orderEditor.new()">Новое</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.orderEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.orderEditor.push()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Направление -->


    <!-- Онкослучай -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="onkoEventEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Сведения о случае лечения онкологического заболевания</strong>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="onkoEventEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link  active"
                               href="#onkoEventEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link"
                               href="#onkoEventEditor_Tab_List">
                                Список
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl.length}]}
                                </span>
                            </a>
                        </li>
                        
                    </ul>
                    <div class="tab-content" id="onkoEventEditor_TabsContent">
                        <div class="tab-pane fade" id="onkoEventEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список онкослучаев пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4 pt-4">
                                <div class="col-12 pb-4">
                                    <div class="row px-4 py-2"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl.length"
                                         data-ng-repeat="onk_sl in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl">
                                         <div class="col-12">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.onkoEventEditor.toEditor(onk_sl._id)">
                                               Онкослучай № {[{$index+ 1}]} 
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="onkoEventEditor_Tab_Editor">
                            <div class="row pt-4">
                                <div class="col-12">
                                    <div class="alert alert-warning"
                                         data-ng-if="talonAmbCtr.onkoEventEditorModel._id == undefined">
                                        Для работы с вложенным элементами (<strong>Онкоуслуга, диагностический блок, противопоказания</strong>) необходимо добавить или выбрать онкослучай
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row pt-4">
                               <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">
                                        <span class="badge badge-dark ng-binding">
                                            {[{talonAmbCtr.onkoEventEditorModel.ds1_t || 'Нет'}]}
                                        </span>
                                        Повод обращения
                                    </label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoEventEditorModel.ds1_t">
                                        <option value="0">Первичное лечение (лечение пациента за исключением прогрессирования и рецидива)</option>
                                        <option value="1">Лечение при рецидиве</option>
                                        <option value="2">Лечение при прогрессировании</option>
                                        <option value="3">Динамическое наблюдение</option>
                                        <option value="4">Диспансерное наблюдение (здоров/ремиссия)</option>
                                        <option value="5">Диагностика (при отсутствии специфического лечения)</option>
                                        <option value="6">Симптоматическое лечение</option>
                                    </select>
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">
                                        <span class="badge badge-dark ng-binding">
                                            {[{talonAmbCtr.onkoEventEditorModel.stad || 'Нет'}]}
                                        </span>
                                        Стадия заболевания
                                    </label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoEventEditorModel.stad">
                                        <option value="" selected>Нет</option>
                                        <option data-ng-value="N002.ID_St"
                                                data-ng-repeat="N002 in talonAmbCtr.refBooks.N002
                                                                                   | filterListField : 'DS_St' : talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds1.split('.')[0]">
                                            {[{N002.KOD_St}]} ({[{N002.DS_St}]}) 
                                        </option>
                                    </select>
                                </div>
                                <div class="col-4">
                                    
                                    <label class="col-12 px-0 m-0 text-truncate">
                                        <span class="badge badge-dark ng-binding">
                                            {[{talonAmbCtr.onkoEventEditorModel.onk_t || 'Нет'}]}
                                        </span>
                                        Значение Tumor
                                    </label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoEventEditorModel.onk_t">
                                        <option value="" selected>Нет</option>
                                        <option data-ng-value="N003.ID_T"
                                                data-ng-repeat="N003 in talonAmbCtr.refBooks.N003
                                                                                   | filterListField : 'DS_T' : talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds1.split('.')[0]">
                                            {[{N003.KOD_T}]} ({[{N003.DS_T}]}) {[{N003.T_NAME}]}
                                        </option>
                                    </select>
                                </div>
                           </div>
                           <div class="row pt-2">
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Значение Nodus</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoEventEditorModel.onk_n">
                                        <option value="" selected>Нет</option>
                                        <option data-ng-value="N004.ID_N"
                                                data-ng-repeat="N004 in talonAmbCtr.refBooks.N004
                                                                                   | filterListField : 'DS_N' : talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds1.split('.')[0]">
                                            {[{N004.KOD_N}]} ({[{N004.DS_N}]}) {[{N004.N_NAME}]}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Значение Metastasis</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoEventEditorModel.onk_m">
                                        <option value="" selected>Нет</option>
                                        <option data-ng-value="N005.ID_M"
                                                data-ng-repeat="N005 in talonAmbCtr.refBooks.N005
                                                                                   | filterListField : 'DS_M' : talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds1.split('.')[0]">
                                            {[{N005.KOD_M}]} ({[{N005.DS_M}]}) {[{N005.M_NAME}]}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Признак выявления отдаленных метастазов</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoEventEditorModel.mtstz">
                                        <option value="" selected>Нет</option>
                                        <option value="1">1 - Выявлены отдаленные метастазы</option>
                                    </select>
                                    
                                </div>

                           </div>
                           <div class="row pt-2 pb-4">
                               <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Суммарная очаговая доза</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.onkoEventEditorModel.sod"
                                           title="Обязательно для заполнения при проведении лучевой или химиолучевой терапии (USL_TIP=3 или USL_TIP=4)">
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Кол-во фракций лучевой теапии</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.onkoEventEditorModel.k_fr"
                                           title="Обязательно для заполнения при проведении лучевой или химиолучевой терапии (USL_TIP=3 или USL_TIP=4)">
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Масса тела (кг)</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.onkoEventEditorModel.wei"
                                           title="Обязательно для заполнения при проведении лучевой или химиолучевой терапии (USL_TIP=3 или USL_TIP=4)">
                                </div>
                                
                            </div>

                            <div class="row">
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Рост (см)</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.onkoEventEditorModel.hei"
                                           title="Обязательно для заполнения при проведении лучевой или химиолучевой терапии (USL_TIP=3 или USL_TIP=4)">
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Площадь поверхности тела (м2)</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.onkoEventEditorModel.bsa"
                                           title="Обязательно для заполнения при проведении лучевой или химиолучевой терапии (USL_TIP=3 или USL_TIP=4)">
                                </div>
                                <div class="col-4 pt-4"></div>
                            </div>

                            <div class="row pt-4">
                                <div class="col-4">
                                    <a class="btn btn-primary btn-block"
                                       data-toggle="modal"
                                       data-dismiss="modal"
                                       data-ng-disabled="talonAmbCtr.onkoEventEditorModel._id == undefined"
                                       data-ng-click="talonAmbCtr.getRefBooks(['N013', 'N014', 'N015', 'N016', 'N017'])"
                                       href="#onkoServiceEditor_Modal">Онкоуслуга
                                            <span class="badge badge-primary"
                                                  data-ng-if="talonAmbCtr.onkoEventEditorModel._id != undefined">
                                                {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl.length}]}
                                            </span>
                                    </a>
                                </div>
                                <div class="col-4">
                                    <a class="btn btn-primary btn-block"
                                       data-toggle="modal"
                                       data-dismiss="modal"
                                       data-ng-disabled="talonAmbCtr.onkoEventEditorModel._id == undefined"
                                       data-ng-click="talonAmbCtr.getRefBooks(['N007', 'N010', 'N008', 'N011'])"
                                       href="#onkoDiagEditor_Modal">Диагностический блок
                                            <span class="badge badge-primary"
                                                  data-ng-if="talonAmbCtr.onkoEventEditorModel._id != undefined">
                                                {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_diag.length}]}
                                            </span>
                                    </a>
                                </div>
                                <div class="col-4">
                                    <a class="btn btn-primary btn-block"
                                       data-toggle="modal"
                                       data-dismiss="modal"
                                       data-ng-disabled="talonAmbCtr.onkoEventEditorModel._id == undefined"
                                       data-ng-click="talonAmbCtr.getRefBooks(['N001'])"
                                       href="#onkoRejectionEditor_Modal">Противопоказания и отказы
                                            <span class="badge badge-primary"
                                                  data-ng-if="talonAmbCtr.onkoEventEditorModel._id != undefined">
                                                {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_prot.length}]}
                                            </span>
                                    </a>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.onkoEventEditor.new()">Новый</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.onkoEventEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.onkoEventEditor.push()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Онкослучай -->

    <!-- Диагностический блок -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="onkoDiagEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Диагностический блок</strong>
                    <button type="button" 
                            class="close" 
                            data-toggle="modal"
                            data-target="#onkoEventEditor_Modal"
                            data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="onkoDiagEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link active"
                               href="#onkoDiagEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link"
                               href="#onkoDiagEditor_Tab_List">
                                Список
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_diag.length}]}
                                </span>
                            </a>
                        </li>
                        
                    </ul>
                    <div class="tab-content" id="onkoDiagEditor_TabsContent">
                        <div class="tab-pane fade " id="onkoDiagEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_diag.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список диагнозов пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4 pt-4">
                                <div class="col-12 pb-4">
                                    <div class="row px-4 py-2"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_diag.length"
                                         data-ng-repeat="onkoDiag in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_diag">
                                         
                                         <div class="col-12">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.onkoDiagEditor.toEditor(onkoDiag._id)">
                                                Диагноз № {[{$index+ 1}]} ( от {[{onkoDiag.diag_date}]} ) 
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="onkoDiagEditor_Tab_Editor">
                            <div class="row pt-4">
                               <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Дата взятия материала</label>
                                    <input type="text"
                                           placeholder="ДД.ММ.ГГГГ"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.onkoDiagEditorModel.diag_date">
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Тип диагностического показателя</label>
                                    <!-- <input type="text"
                                           placeholder="ДД.ММ.ГГГГ"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.onkoDiagEditorModel.diag_tip"> -->
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoDiagEditorModel.diag_tip">
                                        <option value="">Нет</option>
                                        <option value="1">Гистологический признак</option>
                                        <option value="2">Маркер (ИГХ)</option>
                                    </select>
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Код диагностического показателя</label>
                                    <!-- <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoDiagEditorModel.diag_code">
                                        <option value="">Нет</option>
                                        <option value="1">Гистологический признак</option>
                                        <option value="2">Маркер (ИГХ)</option>
                                    </select> -->
                                    <div data-ng-if="talonAmbCtr.onkoDiagEditorModel.diag_tip == 1">
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.onkoDiagEditorModel.diag_code">
                                            <option data-ng-value="N007.ID_Mrf"
                                                    data-ng-repeat="N007 in talonAmbCtr.refBooks.N007">
                                                {[{N007.Mrf_NAME}]}
                                            </option>
                                        </select>
                                    </div>
                                    <div data-ng-if="talonAmbCtr.onkoDiagEditorModel.diag_tip == 2">
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.onkoDiagEditorModel.diag_code">
                                            <option data-ng-value="N010.ID_Igh"
                                                    data-ng-repeat="N010 in talonAmbCtr.refBooks.N010">
                                                {[{N010.Igh_NAME}]} ({[{N010.KOD_Igh}]})
                                            </option>
                                        </select>
                                    </div>
                                    
                                </div>
                           </div>
                           <div class="row pt-4 pb-4">
                               <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Код результата диагностики</label>
                                    <!-- <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoDiagEditorModel.diag_rslt">
                                        <option value="1">Гистологический признак</option>
                                        <option value="2">Маркер (ИГХ)</option>
                                    </select> -->
                                    <div data-ng-if="talonAmbCtr.onkoDiagEditorModel.diag_tip == 1">
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.onkoDiagEditorModel.diag_rslt">
                                            <option data-ng-value="N008.ID_R_M"
                                                    data-ng-repeat="N008 in talonAmbCtr.refBooks.N008">
                                                {[{N008.R_M_NAME}]}
                                            </option>
                                        </select>
                                    </div>
                                    <div data-ng-if="talonAmbCtr.onkoDiagEditorModel.diag_tip == 2">
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.onkoDiagEditorModel.diag_rslt">
                                            <option data-ng-value="N011.ID_R_I"
                                                    data-ng-repeat="N011 in talonAmbCtr.refBooks.N011">
                                                {[{N011.R_I_NAME}]} ({[{N011.KOD_R_I}]})
                                            </option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-8">
                                    <label class="col-12 px-0 m-0 text-truncate">Признак получения результата диагностики</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoDiagEditorModel.rec_rslt">
                                        <option value="">Нет</option>
                                        <option value="1">Да</option>
                                    </select>
                                </div>
                           </div>
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.onkoDiagEditor.new()">Новый</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.onkoDiagEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.onkoDiagEditor.push()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Диагностический блок -->

    <!-- Противопоказания и отказы -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="onkoRejectionEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Сведения об имеющихся противопоказаниях и отказах</strong>
                    <button type="button" 
                            class="close" 
                            data-toggle="modal"
                            data-target="#onkoEventEditor_Modal"
                            data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="onkoRejectionEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link active"
                               href="#onkoRejectionEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link"
                               href="#onkoRejectionEditor_Tab_List">
                                Список
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_prot.length}]}
                                </span>
                            </a>
                        </li>
                        
                    </ul>
                    <div class="tab-content" id="onkoRejectionEditor_TabsContent">
                        <div class="tab-pane fade" id="onkoRejectionEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_prot.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список имеющихся противопоказаний и отказов пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4">
                                <div class="col-12 pb-4">
                                    <div class="row px-4"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_prot.length"
                                         data-ng-repeat="b_prot in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].b_prot">
                                         
                                         <div class="col-12">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.onkoRejectionEditor.toEditor(b_prot._id)">
                                                Противопоказание или отказ № {[{$index+ 1}]} ( от {[{b_prot.d_prot}]} ) 
                                            </a>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="onkoRejectionEditor_Tab_Editor">
                           <div class="row pt-4 pb-4">
                               <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Код противопоказания или отказа</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoRejectionEditorModel.prot">
                                        <option value="0">Отказ от проведения гистологического исследования</option>
                                        <option value="1">Противопоказания к проведению хирургического лечения</option>
                                        <option value="2">Противопоказания к проведению химиотерапевтического лечения</option>
                                        <option value="3">Противопоказания к проведению лучевой терапии</option>
                                        <option value="4">Отказ от проведения хирургического лечения</option>
                                        <option value="5">Отказ от проведения химиотерапевтического лечения</option>
                                        <option value="6">Отказ от проведения лучевой терапии</option>
                                        <option value="7">Гистологическое подтверждение диагноза не показано</option>
                                        <option value="8">Противопоказания к проведению гистологического исследования</option>
                                    </select>
                                </div>
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Дата регистрации противопоказания или отказа</label>
                                    <input type="text"
                                           class="form-control"
                                           placeholder="ДД.ММ.ГГГГ"
                                           data-ng-model="talonAmbCtr.onkoRejectionEditorModel.d_prot">
                                </div>
                           </div>
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.onkoRejectionEditor.new()">Новый</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.onkoRejectionEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.onkoRejectionEditor.push()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Противопоказания и отказы -->

    <!-- Онкоуслуги -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="onkoServiceEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Сведения об услуге при лечении онкологического заболевания</strong>
                    <button type="button" 
                            class="close" 
                            data-toggle="modal"
                            data-target="#onkoEventEditor_Modal"
                            data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="onkoServiceEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link active"
                               href="#onkoServiceEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link"
                               href="#onkoServiceEditor_Tab_List">
                                Список
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl.length}]}
                                </span>
                            </a>
                        </li>
                        
                    </ul>
                    <div class="tab-content" id="onkoServiceEditor_TabsContent">
                        <div class="tab-pane fade" id="onkoServiceEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список онкоуслуг пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4 pt-4">
                                <div class="col-12 pb-4">
                                    <div class="row px-4 py-2"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl.length"
                                         data-ng-repeat="onkoService in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl">
                                         <div class="col-12">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.onkoServiceEditor.toEditor(onkoService._id)">    
                                                Онкоуслуга № {[{$index+ 1}]} 
                                            </a>
                                         </div>
                                         <!-- <div class="col-3">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.onkoServiceEditor.toEditor(onkoService._id)">
                                                {[{onkoService.usl_tip}]}
                                            </a>
                                        </div>
                                        <div class="col-3">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.onkoServiceEditor.toEditor(onkoService._id)">
                                                {[{onkoService.hir_tip}]}
                                            </a>
                                        </div> -->
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="onkoServiceEditor_Tab_Editor">
                           <div class="row pt-4">
                               <div class="col-4">
                                   <label class="col-12 px-0 m-0 text-truncate">Тип услуги</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoServiceEditorModel.usl_tip">
                                        <option value="1">Хирургическое лечение</option>
                                        <option value="2">Лекарственная противоопухолевая терапия</option>
                                        <option value="3">Лучевая терапия</option>
                                        <option value="4">Химиолучевая терапия</option>
                                        <option value="5">Неспецифическое лечение (осложнения противоопухолевой терапии, установка/замена порт системы (катетера), прочее)</option>
                                        <option value="6">Диагностика</option>
                                    </select>
                               </div>
                               <div class="col-4">
                                   <label class="col-12 px-0 m-0 text-truncate">Тип хирургического лечения</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoServiceEditorModel.hir_tip">
                                        <option value="1">Первичной опухоли, в том числе с удалением регионарных лимфатических узлов</option>
                                        <option value="2">Метастазовя</option>
                                        <option value="3">Симптоматическое, реконструктивно-пластическое, хирургическая овариальная суперссия, прочее</option>
                                        <option value="4">Выполнено хирургическое стадирование (может указываться при раке яичника вместо "1")</option>
                                        <option value="5">Регионарных лимфатических узлов без первичной опухоли</option>
                                        <option value="6">Криохирургия/криотерапия, лазерная деструкция, фотодинамическая терапия</option>
                                    </select>
                               </div>
                               <div class="col-4">
                                   <label class="col-12 px-0 m-0 text-truncate">Линия лекарственной терапии</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoServiceEditorModel.lek_tip_l">
                                        <option value="1">Первая линия</option>
                                        <option value="2">Вторая линия</option>
                                        <option value="3">Третья линия</option>
                                        <option value="4">Линия после третьей</option>
                                        <option value="5">Неоадъювантная</option>
                                        <option value="6">Адъювантная</option>
                                        <option value="7">Периоперационная (до хирургического лечения)</option>
                                        <option value="8">Периоперационная (после хирургического лечения)</option>
                                    </select>
                               </div>
                           </div>
                           <div class="row pt-2 pb-4">
                               <div class="col-4">
                                   <label class="col-12 px-0 m-0 text-truncate">Цикл лекарственной терапии</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoServiceEditorModel.lek_tip_v">
                                        <option value="1">Первый цикл линии</option>
                                        <option value="2">Последующие циклы линии (кроме последнего)</option>
                                        <option value="3">Последний цикл линии (лечение прервано)</option>
                                        <option value="4">Последний цикл линии (лечение завершено)</option>
                                    </select>
                               </div>
                               <div class="col-4">
                                   <label class="col-12 px-0 m-0 text-truncate">Тип лучевой терапии</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoServiceEditorModel.luch_tip">
                                        <!-- <option value="0">Первичное лечение (лечение пациента за исключением прогрессирования и рецидива)</option>
                                        <option value="1">Лечение при рецидиве</option>
                                        <option value="2">Лечение при прогрессировании</option>
                                        <option value="3">Динамическое наблюдение</option>
                                        <option value="4">Диспансерное наблюдение (здоров/ремиссия)</option>
                                        <option value="5">Диагностика (при отсутствии специфического лечения)</option>
                                        <option value="6">Симптоматическое лечение</option> -->
                                        <option value="">Нет</option>
                                        <option data-ng-value="N017.ID_TLuch"
                                                    data-ng-repeat="N017 in talonAmbCtr.refBooks.N017">
                                                {[{N017.ID_TLuch}]} - {[{N017.TLuch_NAME}]}
                                        </option>

                                    </select>
                               </div>
                               <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Профилактика тошноты и рвотного рефлекса</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoEventEditorModel.pptr">
                                        <option value=null>Не применялась</option>
                                        <option value="1">1 - Применялась</option>
                                    </select>
                                    
                                </div>
                               
                           </div>
                           <div class="row pt-2">
                               <div class="col-4">
                                   <button type="button"
                                           data-toggle="modal"
                                           data-dismiss="modal"
                                           data-target="#onkoDragEditor_Modal"
                                           data-ng-click="talonAmbCtr.getRefBooks(['N020', 'V024'])"
                                           class="btn btn-primary mt-2 btn-block">
                                        Лекарственный препарат
                                        <span class="badge badge-light">
                                            {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl[talonAmbCtr.onkoServiceEditorModel._id].lek_pr.length}]}
                                        </span>
                                    </button>
                               </div>
                           </div>
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.onkoServiceEditor.new()">Новый</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.onkoServiceEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.onkoServiceEditor.push()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Онкоуслуги -->

    <!-- Лекарственный препарат -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="onkoDragEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Сведения о введенном противоопухолевом лекарственном препарате</strong>
                    <button type="button" 
                            class="close" 
                            data-toggle="modal"
                            data-target="#onkoEventEditor_Modal"
                            data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="onkoDragEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link active"
                               href="#onkoDragEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link"
                               href="#onkoDragEditor_Tab_List">
                                Список
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl[talonAmbCtr.onkoServiceEditorModel._id].lek_pr.length}]}
                                </span>
                            </a>
                        </li>
                        
                    </ul>
                    <div class="tab-content" id="onkoDragEditor_TabsContent">
                        <div class="tab-pane fade" id="onkoDragEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl[talonAmbCtr.onkoServiceEditorModel._id].lek_pr.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список противоопухолевых лекарственных препаратов пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4">
                                <div class="col-12 pb-4 pt-4">
                                    <div class="row px-4 py-2"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl[talonAmbCtr.onkoServiceEditorModel._id].lek_pr.length"
                                         data-ng-repeat="onkoDrag in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl[talonAmbCtr.onkoEventEditorModel._id].onk_usl[talonAmbCtr.onkoServiceEditorModel._id].lek_pr">
                                         
                                         <div class="col-12">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.onkoDragEditor.toEditor(onkoDrag._id)">
                                                Препарат № {[{$index+ 1}]} ( от {[{onkoDrag.date_inj}]} ) 
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="onkoDragEditor_Tab_Editor">
                           <div class="row pt-4 pb-4">
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Дата введения лекарственного препарата</label>
                                    <input type="text"
                                           class="form-control"
                                           placeholder="ДД.ММ.ГГГГ"
                                           data-ng-model="talonAmbCtr.onkoDragEditorModel.date_inj">
                                </div>
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Регистрационный номер лекарственного препарата</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoDragEditorModel.regnum">
                                        <option data-ng-value="N020.ID_LEKP"
                                                data-ng-repeat="N020 in talonAmbCtr.refBooks.N020">
                                            {[{N020.MNN}]}
                                        </option>
                                    </select>
                                </div>
                           </div>
                           <div class="row">
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Код схемы лекарственной терапии (ручной ввод)</label>
                                    <input type="text"
                                           class="form-control"
                                           placeholder=""
                                           data-ng-model="talonAmbCtr.onkoDragEditorModel.code_sh">
                                </div>
                               <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Код схемы лекарственной терапии (выбор из списка)</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.onkoDragEditorModel.code_sh">
                                        <option data-ng-value="V024.IDDKK"
                                                data-ng-repeat="V024 in talonAmbCtr.refBooks.V024">
                                            {[{V024.IDDKK}]} - {[{V024.DKKNAME}]}
                                        </option>
                                    </select>
                                </div>
                           </div>
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.onkoDragEditor.new()">Новый</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.onkoDragEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.onkoDragEditor.push()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Лекарственный препарат -->

    <!-- Услуга -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="uslEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Сведения об услуге</strong>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="uslEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link active"
                               href="#uslEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link"
                               href="#uslEditor_Tab_List">
                                Список
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].usl.length}]}
                                </span>
                            </a>
                        </li>
                        
                    </ul>
                    <div class="tab-content" id="uslEditor_TabsContent">
                        <div class="tab-pane fade" id="uslEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].usl.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список услуг пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4">
                                <div class="col-12 pb-4">

                                    <div class="row pt-4 px-4"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].usl.length"
                                         data-ng-repeat="usl in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].usl">
                                        <div class="col-1 py-2 border-bottom">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.uslEditor.toEditor(usl._id)">
                                                {[{usl.idserv}]}
                                            </a>
                                        </div>

                                        <div class="col-2 py-2 border-bottom">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.uslEditor.toEditor(usl._id)">
                                                {[{usl.date_in}]}
                                            </a>
                                        </div>

                                        <div class="col-2 py-2 border-bottom">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.uslEditor.toEditor(usl._id)">
                                                {[{usl.date_out}]}
                                            </a>
                                        </div>

                                        <div class="col-7 py-2 border-bottom">
                                            {[{usl.code_usl}]}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="uslEditor_Tab_Editor">
                            <div class="row pt-4">
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Номер записи в реестре услуг</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.idserv">
                                </div>
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Дата начала оказания услуги</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.date_in">
                                </div>
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Дата окончания оказания услуги</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.date_out">
                                </div>
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Количество услуг</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.kol_usl"
                                           title="Количество услуг (кратность услуги)">
                                </div>
                            </div>

                            <div class="row pt-2">
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Код МО</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.lpu">
                                </div>
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Подразделение МО</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.lpu_1">
                                </div>
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Код отделения</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.podr">
                                </div>
                                
                                
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Признак детского профиля</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.uslEditorModel.det">
                                        <option value=0>0 - нет</option>
                                        <option value=1>1 - да</option>
                                    </select>
                                </div>
                            </div>

                            <div class="row pt-2">
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Диагноз</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.ds">
                                </div>
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Профиль медицинской помощи</label>
                                    <select class="form-control"
                                            data-ng-model="talonAmbCtr.uslEditorModel.profil">
                                        <option data-ng-value="V002.IDPR"
                                                data-ng-repeat="V002 in talonAmbCtr.refBooks.V002">
                                            {[{V002.IDPR}]} - {[{V002.PRNAME}]}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Вид медицинского вмешательства</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.vid_vme">
                                </div>
                                <div class="col-3">
                                    <label class="col-12 px-0 m-0 text-truncate">Неполный объем</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.uslEditorModel.npl">
                                </div>
                            </div>
                            <div class="row pt-2">
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Код медицинского работника</label>
                                    <div class="input-group">
                                        <input type="text"
                                               class="form-control"
                                               data-ngg-value="talonAmbCtr.talonEditorModel._doctor.snils"
                                               data-ng-model="talonAmbCtr.uslEditorModel.code_md"
                                               title="Код медицинского работника, оказавшего медицинскую услугу">
                                        <div class="input-group-append">
                                            <button class="btn btn-primary"
                                                    data-toggle="modal"
                                                    data-target="#doctorUSL"
                                                    data-dismiss="modal">
                                                <i class="fa fa-pencil" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                    </div>
                                    
                                </div>
                                <div class="col-8">
                                    <label class="col-12 px-0 m-0 text-truncate">Специальность медработника</label>
                                    <div class="input-group">
                                        <input type="text"
                                               class="form-control col-3"
                                               data-ngg-value="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].prvs"
                                               data-ng-model="talonAmbCtr.uslEditorModel.prvs"
                                               title="Специальность медработника, выполнившего услугу">
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.uslEditorModel.prvs"
                                                title="Специальность медработника, выполнившего услугу"
                                                data-ngg-value="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].prvs">
                                            <option data-ng-value="V021.id"
                                                    data-ng-repeat="V021 in talonAmbCtr.nsi.V021.list">
                                                {[{V021.id}]} - {[{V021.name}]}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                                
                                
                            </div>
                            <div class="row pt-2">
                                <div class="col-12">
                                    <label class="col-12 px-0 m-0 text-truncate">Код услуги (Поиск по списку тарифообразующих услуг)</label>
                                    <div class="input-group">
                                        <input type="text"
                                               placeholder="Код"
                                               class="form-control col-1 text-center"
                                               data-ng-model="talonAmbCtr.filters.uslEditorModel.code">
                                        <input type="text"
                                               name="patientName"
                                               placeholder="Поиск названия"
                                               class="form-control col-2 text-center"
                                               data-ng-model="talonAmbCtr.filters.uslEditorModel.name">
                                               <!-- | filterListField : 'usl_ok' : talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok -->
                                        <select class="form-control"
                                                data-ng-change="talonAmbCtr.selectUslTarif()"
                                                data-ng-model="talonAmbCtr.uslEditorModel.code_usl">
                                            <option data-ng-value="usl.usl.code"
                                                    data-ng-repeat="usl in talonAmbCtr.refBooksDinamic.usls 
                                                                                      | filterServiceTarif : 'code' : talonAmbCtr.filters.uslEditorModel.code
                                                                                      | filterServiceTarif : 'name' : talonAmbCtr.filters.uslEditorModel.name">
                                                {[{usl.usl.code}]} - {[{usl.usl.name}]}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-2">
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Код услуги (Поиск по общему списку услуг)</label>
                                    <div class="input-group">
                                        <input type="text"
                                               name="patientName"
                                               placeholder="Код услуги"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.filters.uslsReg.code">
                                        <input type="text"
                                               name="patientName"
                                               placeholder="Название услуги"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.filters.uslsReg.name">
                                        <div class="input-group-append">
                                            <button type="button"
                                                    data-ng-click="talonAmbCtr.getUslsReg()"
                                                    class="btn btn-primary">
                                                <i class="fa fa-fw fa-search" aria-hidden="true"></i>   
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-8">
                                    <label class="col-12 px-0 m-0 text-truncate">Результаты поиска</label>
                                    <select class="form-control"
                                            data-ng-change="talonAmbCtr.clearUslTarifSumm()"
                                            data-ng-model="talonAmbCtr.uslEditorModel.code_usl">
                                        <option data-ng-value="usl.uslCode"
                                                data-ng-repeat="usl in talonAmbCtr.refBooksDinamic.uslsReg">
                                            {[{usl.uslCode}]} - {[{usl.uslName}]}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div class="row pt-2 pb-4">
                                
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Код услуги </label>
                                    <input type="text"
                                               placeholder="Код"
                                               class="form-control font-weight-bold"
                                               data-ng-model="talonAmbCtr.uslEditorModel.code_usl">
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Тариф</label>
                                    <input type="text"
                                           class="form-control font-weight-bold"
                                           data-ng-model="talonAmbCtr.uslEditorModel.tarif">
                                </div>
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Стоимость мед услуги (руб.)</label>
                                    
                                    <div class="input-group">
                                        <input type="text"
                                           class="form-control font-weight-bold"
                                           data-ng-model="talonAmbCtr.uslEditorModel.sumv_usl"
                                           title="Стоимость медицинской услуги, выставленная к оплате (руб.)">
                                        <div class="input-group-append">
                                            <button type="button"
                                                    class="btn btn-primary"
                                                    data-ng-click="talonAmbCtr.calcUslTarif()">
                                                <i class="fa fa-calculator fa-fw"></i>     
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.uslEditor.new()">Новая</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.uslEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.uslEditor.push()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Услуга -->


    <!-- КСГ -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="ksgEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>КСГ</strong>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    
                    <div class="tab-content" id="ksgEditor_TabsContent">
                        <div class="row pt-2">
                            <div class="col-12">
                                <div class="alert alert-warning"
                                     data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg == null">
                                    Для работы с <strong>КСЛП</strong> и <strong>Кл. критерий</strong> необходимо добавить <strong>КСГ</strong>
                                </div>
                            </div>
                        </div>
                        <div class="row pt-4">
                            <div class="col-3">
                                <label class="col-12 px-0 m-0 text-truncate">Номер КСГ</label>
                                <input type="text"
                                       class="form-control"
                                       data-ng-model="talonAmbCtr.ksgEditorModel.n_ksg">
                            </div>
                            <div class="col-3">
                                <label class="col-12 px-0 m-0 text-truncate">Модель определения КСГ</label>
                                <input type="text"
                                       class="form-control"
                                       placeholder="2019 (текущий год)" 
                                       data-ng-model="talonAmbCtr.ksgEditorModel.ver_ksg">
                            </div>
                            <div class="col-3">
                                <label class="col-12 px-0 m-0 text-truncate">Признак использования подгруппы КСГ</label>
                                <input type="text"
                                       class="form-control"
                                       data-ng-model="talonAmbCtr.ksgEditorModel.ksg_pg">
                            </div>
                            <div class="col-3">
                                <label class="col-12 px-0 m-0 text-truncate">Коэффициент затратоемкости</label>
                                <input type="text"
                                       class="form-control"
                                       data-ng-model="talonAmbCtr.ksgEditorModel.koef_z">
                            </div>
                        </div>
                        <div class="row pt-4">
                            <div class="col-3">
                                <label class="col-12 px-0 m-0 text-truncate">Управленческий коэффициент</label>
                                <input type="text"
                                       class="form-control"
                                       data-ng-model="talonAmbCtr.ksgEditorModel.koef_up">
                            </div>
                            <div class="col-3">
                                <label class="col-12 px-0 m-0 text-truncate">Базовая ставка</label>
                                <input type="text"
                                       class="form-control"
                                       data-ng-model="talonAmbCtr.ksgEditorModel.bztsz">
                            </div>
                            <div class="col-3">
                                <label class="col-12 px-0 m-0 text-truncate">Коэффициент дифференциации</label>
                                <input type="text"
                                       class="form-control"
                                       data-ng-model="talonAmbCtr.ksgEditorModel.koef_d">
                            </div>
                            <div class="col-3">
                                <label class="col-12 px-0 m-0 text-truncate">Коэф. уровня/подуровня оказания медицинской помощи</label>
                                <input type="text"
                                       class="form-control"
                                       data-ng-model="talonAmbCtr.ksgEditorModel.koef_u">
                            </div>
                        </div>
                        <div class="row pt-4">
                            <div class="col-6">
                                <label class="col-12 px-0 m-0 text-truncate">Признак использования КСЛП</label>
                                <input type="text"
                                       class="form-control"
                                       data-ng-model="talonAmbCtr.ksgEditorModel.sl_k">
                            </div>
                            <div class="col-6">
                                <label class="col-12 px-0 m-0 text-truncate">Примененный коэф. сложности лечения пациента</label>
                                <input type="text"
                                       class="form-control"
                                       data-ng-model="talonAmbCtr.ksgEditorModel.it_sl">
                            </div>
                            
                        </div>
                        <div class="row pt-4">
                            <div class="col-8">
                                
                            </div>
                            <div class="col-2">
                                <button type="button"
                                        data-toggle="modal" 
                                        data-dismiss="modal"
                                        data-target="#slkoefEditor_Modal"
                                        data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg == null"
                                        class="btn btn-primary btn-block">
                                        КСЛП
                                        <span class="badge badge-light"
                                              data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg != null">
                                            {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.sl_koef.length}]}
                                        </span>
                                </button>
                            </div>
                            <div class="col-2">
                                <button type="button"
                                        data-toggle="modal" 
                                        data-dismiss="modal"
                                        data-target="#critEditor_Modal"
                                        data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg == null"
                                        class="btn btn-primary btn-block">
                                        Кл. критерий
                                        <span class="badge badge-light"
                                              data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg != null">
                                            {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.crit.length}]}
                                        </span>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <hr>
                            </div>
                        </div>
                        <div class="row pt-1">
                            <div class="col-4 text-right">
                                <button type="button"
                                        class="btn btn-outline-success btn-block"
                                        data-ng-click="talonAmbCtr.ksgEditor.new()">Новый</button>
                            </div>
                            <div class="col-4 text-right">
                                <button type="button"
                                        class="btn btn-outline-danger btn-block"
                                        data-ng-click="talonAmbCtr.ksgEditor.pop()">Удалить</button>
                            </div>
                            <div class="col-4 text-right">
                                <button type="button"
                                        class="btn btn-primary btn-block"
                                        data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg == null"
                                        data-ng-click="talonAmbCtr.ksgEditor.push()">Добавить</button>
                                <button type="button"
                                        class="btn btn-primary btn-block"
                                        data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg != null"
                                        data-ng-click="talonAmbCtr.ksgEditor.push()">Сохранить</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- КСГ -->


    <!-- КОЭФ СЛОЖНОСТИ -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="slkoefEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Коэффицент сложности</strong>
                    <button type="button" class="close" data-dismiss="modal" data-toggle="modal" data-target="#ksgEditor_Modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="slkoefEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab"
                               class="nav-link active"
                               href="#slkoefEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab"
                               class="nav-link "
                               href="#slkoefEditor_Tab_List">
                                Список
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.sl_koef.length}]}
                                </span>
                            </a>
                        </li>
                        
                    </ul>
                    <div class="tab-content" id="slkoefEditor_TabsContent">
                        <div class="tab-pane fade" id="slkoefEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.sl_koef.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список коэффицентов сложности пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4">
                                <div class="col-12 pb-4">
                                    <div class="row px-4"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.sl_koef.length"
                                         data-ng-repeat="sl_koef in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.sl_koef">
                                         <div class="col-6 py-2 border-bottom">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.slkoefEditor.toEditor(sl_koef._id)">
                                                {[{sl_koef.idsl}]}
                                            </a>
                                        </div>
                                        <div class="col-6 py-2 border-bottom">
                                            {[{sl_koef.z_sl}]}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade  show active" id="slkoefEditor_Tab_Editor">
                            <div class="row pt-4">
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Номер коэффициента сложности лечения пациента</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.slkoefEditorModel.idsl">
                                </div>
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Значение коэффициента сложности лечения пациента</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.slkoefEditorModel.z_sl">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.slkoefEditor.new()">Новый</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.slkoefEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.slkoefEditor.push()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- КОЭФ СЛОЖНОСТИ -->


    <!-- CRIT -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="critEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Классификационный критерий</strong>
                    <button type="button" class="close" data-dismiss="modal" data-toggle="modal" data-target="#ksgEditor_Modal"  aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="critEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab"
                               class="nav-link active"
                               href="#critEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab"
                               class="nav-link"
                               href="#critEditor_Tab_List">
                                Список 
                                <span class="badge badge-primary">
                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.crit.length}]}
                                </span>
                            </a>
                        </li>
                        
                    </ul>
                    <div class="tab-content" id="critEditor_TabsContent">
                        <div class="tab-pane fade " id="critEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.crit.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список критериев. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pb-4">
                                <div class="col-12 pb-4">
                                    <div class="row px-4"
                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.crit.length"
                                         data-ng-repeat="crit in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg.crit">
                                         <div class="col-12 py-2 border-bottom">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.critEditor.toEditor(crit._id)">
                                                {[{crit.crit}]}
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="critEditor_Tab_Editor">
                            <div class="row pt-4">
                                <div class="col-4">
                                    <label class="col-12 px-0 m-0 text-truncate">Доп. критерий</label>
                                    
                                    <div class="input-group">
                                        <input type="text"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.critEditorModel.crit">
                                        <div class="input-group-append">
                                            <button type="button" 
                                                    class="btn btn-danger"
                                                    data-ng-click="talonAmbCtr.nullCrit()">
                                                Нет            
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-8">
                                    <label class="col-12 px-0 m-0 text-truncate">Выбрать из классификатора классификационных критериев</label>
                                    <select class="form-control"
                                                    data-ng-model="talonAmbCtr.critEditorModel.crit">
                                                <option data-ng-value="V024.IDDKK"
                                                        data-ng-repeat="V024 in talonAmbCtr.refBooks.V024">
                                                    {[{V024.IDDKK}]} - {[{V024.DKKNAME}]}
                                                </option>
                                            </select>
                                </div>
                            </div>
                            <div class="row pt-3">
                                <div class="col-4"></div>
                                <div class="col-8">
                                    <div class="alert alert-danger">
                                        Значение поля <strong>&laquo;Доп. критерий&raquo;</strong> соответствует справочнику V024.
                                        Если случай предполагает <strong>отсутвие</strong> дополнительного критерия, но нажмите <strong>&laquo;Нет&raquo;</strong>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.critEditor.new()">Новый</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.critEditor.pop()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">

                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-if="talonAmbCtr.critEditorModel._id == undefined"
                                            data-ng-click="talonAmbCtr.critEditor.push()">Добавить</button>
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-if="talonAmbCtr.critEditorModel._id != undefined"
                                            data-ng-click="talonAmbCtr.critEditor.update()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- CRIT -->

    <!-- Врач -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="doctor">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="col-6">
                        Врач: <span
                            class="text-primary">
                                  {[{talonAmbCtr.talonEditorModel._doctor.lastname}]}
                                  {[{talonAmbCtr.talonEditorModel._doctor.firstname}]}
                                  {[{talonAmbCtr.talonEditorModel._doctor.middlename}]}
                              </span>
                    </div>
                    <div class="col-5">
                        Специальность: <span
                            <class="text-primary">{[{talonAmbCtr.getSpecializationName() || 'Нет'}]}</span> 
                    </div>
                    <div class="col-1 pr-0">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="row pb-2">
                        <div class="col-8 pl-4">
                            <label class="col-12 px-0 m-0 text-truncate">Фильтр по списку врачей</label>
                            <div class="input-group">
                                <input type="text"
                                       name="patientName"
                                       placeholder="СНИЛС"
                                       class="form-control col-3"
                                       data-ng-model="talonAmbCtr.filters.doctorSelect.snils">
                                <input type="text"
                                       name="patientName"
                                       placeholder="Поиск по фамилии врача"
                                       class="form-control col-6"
                                       data-ng-model="talonAmbCtr.filters.doctorSelect.lastname">
                            </div>
                        </div>
                        <div class="col-4 pr-4">
                            <label class="col-12 px-0 m-0 text-truncate">Выбрать специальность</label>
                            <div class="input-group">
                                <input type="text"
                                       name="patientName"
                                       placeholder="Код"
                                       class="form-control col-3 text-center"
                                       data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].prvs">
                                <select class="form-control"
                                        data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].prvs">
                                    <option data-ng-value="V021.id"
                                            data-ng-repeat="V021 in talonAmbCtr.nsi.V021.list">
                                        {[{V021.id}]} - {[{V021.name}]}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="container border my-4"
                         style="height: 300px; overflow-y: auto;">
                        <div class="row py-2">
                            <div class="col-12">
                                <div class="row"
                                     data-ng-repeat="doctor in talonAmbCtr.doctors | filterListField : 'lastname' : talonAmbCtr.filters.doctorSelect.lastname
                                                                                   | filterListField : 'snils' : talonAmbCtr.filters.doctorSelect.snils">
                                    <div class="col-2 pl-4 py-2 border-bottom">{[{ doctor.snils }]}</div>
                                    <div class="col-10 pl-4 py-2 border-bottom">
                                        <a href="#!"
                                           data-ng-click="talonAmbCtr.selectDoctor(doctor._id)">{[{ doctor.lastname }]} {[{ doctor.firstname }]} {[{ doctor.middlename }]}</a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="row pt-3 border-top">
                        <div class="col-12 text-right">
                            <button type="button"
                                    class="btn btn-primary"
                                    data-ng-click="talonAmbCtr.apiDoctors.read()">
                                Обновить
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Врач -->

    <!-- Врач Услуги -->
    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="doctorUSL">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="col-6">
                        Врач: <span
                            class="text-primary">
                                  {[{talonAmbCtr.getDoctorUslName()}]}
                              </span>
                    </div>
                    <div class="col-5">
                        Специальность: <span
                            class="text-primary">{[{talonAmbCtr.getSpecializationUslName() || 'Нет'}]}</span>
                    </div>
                    <div class="col-1 pr-0">
                        <button type="button" 
                                class="close" 
                                data-dismiss="modal"
                                data-toggle="modal"
                                data-target="#uslEditor_Modal">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="row pb-2">
                        <div class="col-8 pl-4">
                            <label class="col-12 px-0 m-0 text-truncate">Фильтр по списку врачей</label>
                            <div class="input-group">
                                <input type="text"
                                       name="patientName"
                                       placeholder="СНИЛС"
                                       class="form-control col-3"
                                       data-ng-model="talonAmbCtr.filters.doctorSelect.snils">
                                <input type="text"
                                       name="patientName"
                                       placeholder="Поиск по фамилии врача"
                                       class="form-control col-6"
                                       data-ng-model="talonAmbCtr.filters.doctorSelect.lastname">
                            </div>
                        </div>
                        <div class="col-4 pr-4">
                            <label class="col-12 px-0 m-0 text-truncate">Выбрать специальность</label>
                            <div class="input-group">
                                <input type="text"
                                       name="patientName"
                                       placeholder="Код"
                                       class="form-control col-3 text-center"
                                       data-ng-model="talonAmbCtr.uslEditorModel.prvs">
                                <select class="form-control"
                                        data-ng-model="talonAmbCtr.uslEditorModel.prvs">
                                    <option data-ng-value="V021.id"
                                            data-ng-repeat="V021 in talonAmbCtr.nsi.V021.list">
                                        {[{V021.id}]} - {[{V021.name}]}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="container border my-4"
                         style="height: 300px; overflow-y: auto;">
                        <div class="row py-2">
                            <div class="col-12">
                                <div class="row"
                                     data-ng-repeat="doctor in talonAmbCtr.doctors | filterListField : 'lastname' : talonAmbCtr.filters.doctorSelect.lastname
                                                                                   | filterListField : 'snils' : talonAmbCtr.filters.doctorSelect.snils">
                                    <div class="col-2 pl-4 py-2 border-bottom">{[{ doctor.snils }]}</div>
                                    <div class="col-10 pl-4 py-2 border-bottom">
                                        <a href="#!"
                                           data-ng-click="talonAmbCtr.selectDoctorUsl(doctor._id)">{[{ doctor.lastname }]} {[{ doctor.firstname }]} {[{ doctor.middlename }]}</a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="row pt-3 border-top">
                        <div class="col-12 text-right">
                            <button type="button"
                                    class="btn btn-primary"
                                    data-ng-click="talonAmbCtr.apiDoctors.read()">
                                Обновить
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Врач Услуги -->

    <div class="modal modal-container-xl" tabindex="-1" role="dialog" id="checkEditor_Modal">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>Счета</strong>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="checkEditor_Tabs">
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link active"
                               href="#checkEditor_Tab_List">
                                Список
                            </a>
                        </li>
                        <li class="nav-item">
                            <a data-toggle="tab" 
                               class="nav-link"
                               href="#checkEditor_Tab_Editor">
                                Редактор
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content" id="checkEditor_TabsContent">
                        <div class="tab-pane fade show active" id="checkEditor_Tab_List">
                            <div class="row"
                                 data-ng-if="!talonAmbCtr.checks.length">
                                <div class="col-12 py-4 text-center">
                                    <div style="padding: 40px;">
                                        <small>Список счетов пуст. Нажмите кнопку &laquo;Обновить&raquo;</small>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-4 pb-4">
                                <div class="col-12 pb-4">
                                    <div class="row px-4 pt-4"
                                         data-ng-if="talonAmbCtr.checks.length">
                                        <div class="col-2 py-2 border-bottom">
                                            <strong>Год</strong>
                                        </div>
                                        <div class="col-1 py-2 border-bottom">
                                            <strong>Месяц</strong>
                                        </div>
                                        <div class="col-2 py-2 border-bottom">
                                            <strong>Номер счета</strong>
                                        </div>
                                        <div class="col-2 py-2 border-bottom">
                                            <strong>Сумма</strong>
                                        </div>
                                        <div class="col-5 py-2 border-bottom">
                                            
                                        </div>
                                    </div>
                                    <div class="row px-4"
                                         data-ng-if="talonAmbCtr.checks.length"
                                         data-ng-repeat="check in talonAmbCtr.checks">
                                         <div class="col-2 py-2 border-bottom">
                                            {[{check.year}]}
                                        </div>
                                        <div class="col-1 py-2 border-bottom">
                                            {[{check.month}]}
                                        </div>
                                        <div class="col-2 py-2 border-bottom">
                                            <a href="#"
                                               data-dismiss="modal"
                                               data-ng-click="talonAmbCtr.toChecksEditor(check._id, false)">
                                                {[{check.nschet}]}
                                            </a>
                                        </div>
                                        <div class="col-2 py-2 border-bottom">
                                            {[{check.summav}]}
                                        </div>
                                        <div class="col-2 py-2 border-bottom">
                                            <a href="#"
                                               class="btn mt-1 btn-outline-primary btn-sm btn-block"
                                               data-ng-click="talonAmbCtr.toChecksEditor(check._id, true)">
                                                <i class="fa fa-fw fa-pencil" aria-hidden="true"></i>
                                                &nbsp;Изменить
                                            </a>
                                        </div>
                                        <div class="col-2 py-2 border-bottom">
                                            
                                            <div class="dropdown btn-sm">
                                                    <a class="btn btn-outline-success dropdown-toggle  btn-sm btn-block" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                        <i class="fa fa-download" aria-hidden="true"></i> Выгрузка
                                                    </a>

                                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                        <a 
                                                           href="http://10.6.0.159:8000/do/xml/{[{check._id}]}"
                                                           onclick="$('#exportXMLAlert_Modal').modal(); $('#checkEditor_Modal').modal('hide')"
                                                           class="dropdown-item">
                                                            Выгрузить реестр
                                                        </a>
                                                        <a 
                                                           href="http://10.6.0.159:8000/do/xml/fixed/{[{check._id}]}"
                                                           onclick="$('#exportXMLAlert_Modal').modal(); $('#checkEditor_Modal').modal('hide')"
                                                           class="dropdown-item">
                                                            Выгрузить реестр (испр)
                                                        </a>
                                                        <a href="http://10.6.0.159:8000/do/excel/{[{check._id}]}"
                                                           class="dropdown-item" href="#">
                                                            Печатная форма
                                                        </a>
                                                        <a href="http://10.6.0.159/print/{[{check._id}]}"
                                                           class="dropdown-item" href="#">
                                                            Печатная форма 2
                                                        </a>
                                                    </div>
                                                </div>
                                        </div>
                                        <div class="col-1 py-2 border-bottom">
                                            <a href="#"
                                               data-ng-click="talonAmbCtr.calcCheckSumm(check._id)"
                                               class="btn btn-outline-primary btn-sm btn-block mt-1">
                                                <i class="fa fa-fw fa-calculator" aria-hidden="true"></i>   
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 border-top">
                                <div class="col-12 text-right">
                                    <button type="button"
                                            class="btn btn-primary"
                                            data-ng-click="talonAmbCtr.apiChecks.read()">
                                        Обновить
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="checkEditor_Tab_Editor">
                            <div class="row pt-4">
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Отчетный год</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.checkEditorModel.year">
                                </div>
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Отчетный месяц</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.checkEditorModel.month">
                                </div>
                            </div>
                            <div class="row pt-2">
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Номер счета</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.checkEditorModel.nschet">
                                </div>
                                <div class="col-6">
                                    <label class="col-12 px-0 m-0 text-truncate">Дата выставления счета</label>
                                    <input type="text"
                                           class="form-control"
                                           data-ng-model="talonAmbCtr.checkEditorModel.dschet">
                                </div>
                            </div>
                            <div class="row pt-2">
                                <div class="col-12">
                                    <label class="col-12 px-0 m-0 text-truncate">Сумма счета, выставленная МО на оплату</label>
                                    <input type="text"
                                           class="form-control"
                                           placeholder="5000.00" 
                                           data-ng-pattern="/^\d{1,100}\.\d{2}$/"
                                           data-ng-model="talonAmbCtr.checkEditorModel.summav">
                                </div>
                            </div>
                            <!-- <div class="row pt-2">
                                <div class="col-12">
                                    <label class="col-12 px-0 m-0 text-truncate">Комментарий</label>
                                    <textarea rows="5"
                                              class="form-control"
                                              data-ng-model="talonAmbCtr.checkEditorModel.coments"></textarea>
                                </div>
                            </div> -->
                            <div class="row">
                                <div class="col-12">
                                    <hr>
                                </div>
                            </div>
                            <div class="row pt-1">
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-success btn-block"
                                            data-ng-click="talonAmbCtr.emptyCheckEditorModel()">Новый</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-outline-danger btn-block"
                                            data-ng-click="talonAmbCtr.apiChecks.delete()">Удалить</button>
                                </div>
                                <div class="col-4 text-right">
                                    <button type="button"
                                            class="btn btn-primary btn-block"
                                            data-ng-click="talonAmbCtr.apiChecks.save()">Сохранить</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row pt-4">
        <div class="col-12">
            <div class="row pb-4">
                <div class="col-6">
                    <div class="card">
                        <div class="card-header" id="card_DoctorSelect">
                            <strong>Врач</strong>
                        </div>
                        <div class="card-body text-center">
                            <div class="pb-4">

                                <div data-ng-if="talonAmbCtr.talonEditorModel._doctor.name != ''  && talonAmbCtr.getSpecializationName()">
                                    <div>
                                        <span class="text-primary">
                                            {[{talonAmbCtr.talonEditorModel._doctor.lastname}]}
                                            {[{talonAmbCtr.talonEditorModel._doctor.firstname}]}
                                            {[{talonAmbCtr.talonEditorModel._doctor.middlename}]}
                                        </span>
                                    </div>
                                    <div>
                                        <small><span
                                                class="text-secondary">{[{talonAmbCtr.getSpecializationName()}]}</span>
                                        </small>
                                    </div>
                                </div>
                                <div data-ng-if="talonAmbCtr.talonEditorModel._doctor.name == ''  || !talonAmbCtr.getSpecializationName()">
                                    <div>
                                        <span class="text-primary">Врач не выбран</span>
                                    </div>
                                    <div>
                                        <small><span class="text-secondary">Специальность</span></small>
                                    </div>
                                </div>

                            </div>
                            <button type="button" class="btn btn-primary"
                                    data-toggle="modal"
                                    data-target="#doctor">
                                Выбрать
                            </button>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card">
                        <div class="card-header" id="card_CheckSelect">
                            <strong>Счет</strong>
                        </div>
                        <div class="card-body text-center">
                            <div class="row">
                                <div class="col-12 pb-4">
                                    <div data-ng-if="!talonAmbCtr.checkEditorModel._id">
                                        <div>
                                            <span class="text-primary">Счет не выбран</span>
                                        </div>
                                        <div>
                                            <small><span class="text-secondary">Номер счета отсутствует</span></small>
                                        </div>
                                    </div>
                                    <div data-ng-if="talonAmbCtr.checkEditorModel._id">
                                        <div>
                                            <span class="text-primary">
                                                Отчетный год: <strong>{[{talonAmbCtr.checkEditorModel.year}]}</strong>, 
                                                Отчетный месяц: <strong>{[{talonAmbCtr.checkEditorModel.month}]}</strong>
                                            </span>
                                        </div>
                                        <div>
                                            <small>
                                                <span class="text-secondary">
                                                    Номер счета: {[{talonAmbCtr.checkEditorModel.nschet}]}
                                                </span>
                                            </small> 
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <button type="button"
                                            data-target="#checkEditor_Modal"
                                            data-toggle="modal"
                                            class="btn btn-primary">
                                        Выбрать
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <strong>Сведения об оказанной медицинской помощи при подозрении на злокачественное новообразование или установленном диагнозе злокачественного новообразования</strong>
                </div>
                <div class="card-body">
                    <div class="row pb-4">
                        <div class="col-12">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#talonForm"
                                       role="tab">Талон</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#talonList" role="tab">
                                        Список талонов
                                        <span class="badge badge-primary"
                                              data-ng-if="talonAmbCtr.records.length > 0">
                                            {[{talonAmbCtr.records.length}]}
                                        </span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#patientList"
                                       role="tab">Список пациентов</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#validateRecords"
                                       role="tab">Проверка талонов</a>
                                </li>

                            </ul>
                        </div>
                    </div>

                    <div class="tab-content" id="myTabContent">
                        <!-- Поля амбулаторного талона (базовый) -->
                        <div class="tab-pane fade show active" id="talonForm">
                            <form name="talonAmb_Form">
                                <div class="row">
                                    <div class="col-6">
                                        <label class="col-12 px-0 m-0 text-truncate">
                                            Признак исправленной записи
                                        </label>
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pr_nov">
                                            <option value="0" selected>0 - сведения об оказанной медицинской помощи передаются впервые</option>
                                            <option value="1">1 - запись передается повторно после исправления</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12 pt-2 pb-2">
                                        <div>
                                            <hr>
                                        </div>
                                    </div>
                                </div>
                                <div class="row pb-3">
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">1</span>
                                        &nbsp;&nbsp;Фамилия пациента</label>
                                        <input type="text"
                                               name="fam"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.talonEditorModel._pacient.fam">
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Имя пациента</label>
                                        <input type="text"
                                               name="im"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.talonEditorModel._pacient.im">
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Отчество пациента</label>
                                        <input type="text"
                                               name="ot"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.talonEditorModel._pacient.ot">
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">2</span>
                                        &nbsp;&nbsp;Идент. пациента</label>
                                        <div class="input-group">
                                            <input type="text"
                                                   name="idbars"
                                                   class="form-control"
                                                   data-ng-change="talonAmbCtr.setPacientId()"
                                                   data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.id_pac">

                                            <div class="input-group-append">
                                                <button type="button"
                                                        class="btn btn-primary"
                                                        data-ng-click="talonAmbCtr.readPatient('id')">
                                                    <i class="fa fa-fw fa-search" aria-hidden="true"></i>
                                                </button>
                                            </div>

                                        </div>

                                    </div>
                                </div>
                                <div class="row pb-3">
                                    <div class="col-3">
                                        <div class="row">
                                            <div class="col-6">
                                                <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">4</span>&nbsp;&nbsp;Пол</label>
                                                <select class="form-control"
                                                        data-ng-model="talonAmbCtr.talonEditorModel._pacient.w">
                                                    <option value="1">Мужской</option>
                                                    <option value="2">Женский</option>
                                                </select>
                                            </div>
                                            <div class="col-6">
                                                <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">5</span>&nbsp;&nbsp;Дата рождения</label>
                                                <input type="text"
                                                       name="patientName"
                                                       class="form-control"
                                                       data-ng-pattern="/^\d{2}\.\d{2}\.\d{4}$/"
                                                       data-ng-model="talonAmbCtr.talonEditorModel._pacient.dr">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">3</span>&nbsp;&nbsp;СНИЛС</label>
                                        <div class="input-group">
                                            <input type="text"
                                               name="snils"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.talonEditorModel._pacient.snils">
                                            <div class="input-group-append">
                                                <button class="btn btn-primary"
                                                        data-ng-click="talonAmbCtr.readPatient('snils')">
                                                    <i class="fa fa-fw fa-search" aria-hidden="true"></i>
                                                </button>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">6</span>&nbsp;&nbsp;Тип документа уд. личность</label>
                                        <div class="input-group">

                                            <input type="text"
                                                   name="patientName"
                                                   placeholder="Код"
                                                   class="form-control col-2 text-center"
                                                   data-ng-model="talonAmbCtr.talonEditorModel._pacient.doctype">
                                            <select class="form-control"
                                                    data-ng-model="talonAmbCtr.talonEditorModel._pacient.doctype">

                                                <option data-ng-value="F011.id"
                                                        data-ng-repeat="F011 in talonAmbCtr.nsi.F011.list">
                                                    {[{F011.id}]} - {[{F011.name}]}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="row">
                                            <div class="col-5">
                                                <label class="col-12 px-0 m-0 text-truncate">Серия</label>
                                                <input type="text"
                                                       name="patientName"
                                                       class="form-control"
                                                       data-ng-model="talonAmbCtr.talonEditorModel._pacient.docser">
                                            </div>
                                            <div class="col-7">
                                                <label class="col-12 px-0 m-0 text-truncate">Номер</label>
                                                <input type="text"
                                                       name="patientName"
                                                       class="form-control"
                                                       data-ng-model="talonAmbCtr.talonEditorModel._pacient.docnum">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">11</span>
                                            &nbsp;&nbsp;Страховая компания (Код)
                                        </label>
                                        <div class="input-group">
                                            <input type="text"
                                               name="patientName"
                                               class="form-control"
                                               placeholder="65001" 
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.smo">
                                            <div class="input-group-append">
                                                <button type="button"
                                                        data-ng-click="talonAmbCtr.getSMOIdDefault()"
                                                        class="btn btn-primary">СогазМЕД</button>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Документ, подтвержд. факт страхования</label>
                                        <div class="input-group">
                                            <input type="text"
                                                   name="patientName"
                                                   placeholder="Код"
                                                   class="form-control col-2 text-center"
                                                   data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.vpolis">
                                            <select class="form-control"
                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.vpolis">
                                                <option data-ng-value="F008.id"
                                                        data-ng-repeat="F008 in talonAmbCtr.nsi.F008.list">
                                                    {[{F008.name}]}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="row">
                                            <div class="col-5">
                                                <label class="col-12 px-0 m-0 text-truncate">Серия ДПФС</label>
                                                <input type="text"
                                                       name="patientName"
                                                       class="form-control"
                                                       data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.spolis">
                                            </div>
                                            <div class="col-7">
                                                <label class="col-12 px-0 m-0 text-truncate">Номер ДПФС</label>
                                                <input type="text"
                                                       name="patientName"
                                                       class="form-control"
                                                       data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.npolis">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                
                                <div class="row pt-3">
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Признак новорожденного</label>
                                        <div class="input-group">
                                            <input type="text"
                                               name="patientName"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.novor">
                                            <div class="input-group-append">
                                                <button type="button"
                                                        class="btn btn-primary"
                                                        data-ng-click="talonAmbCtr.calcNovor()">
                                                    <i class="fa fa-calculator fa-fw"></i> 
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Вес при рождении (при оказании МП ребенку)</label>
                                        <input type="text"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.vnov_d"
                                               title="Указывается при оказании медицинской помощи недоношенным и маловесным детям. Поле заполняется, если в качестве пациента указан ребенок.">
                                    </div>
                                    <!-- <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Вес при рождении (при оказании МП матери)</label>
                                        <input type="text"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.vnov_m"
                                               title="Продолжительность госпитализации (койко-дни/пациенто-дни)">
                                    </div> -->
                                    <div class="col-6">
                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">10</span>&nbsp;&nbsp;Инвалидность</label>
                                        <div class="input-group">
                                            <input type="text"
                                                   name="patientName"
                                                   placeholder="Код"
                                                   class="form-control col-2 text-center"
                                                   data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.inv">
                                            <select class="form-control"
                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.pacient.inv">
                                                <option data-ng-value=null>Нет</option>
                                                <option data-ng-value="inv.id"
                                                        data-ng-repeat="inv in talonAmbCtr.nsi.inv.list">
                                                    {[{inv.name}]}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row pt-4">
                                    <div class="col-12">
                                        <h5 class="pb-0 mb-0">Законченный случай</h5>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12 pt-2 pb-2">
                                        <div>
                                            <hr>
                                        </div>
                                    </div>
                                </div>
                                
                                
                                <div class="row">
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Условия оказания МП</label>
                                        <select class="form-control"
                                                data-ng-change="talonAmbCtr.setVB_P()"
                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok">
                                            <option value="{[{V006.id}]}"
                                                    data-ng-repeat="V006 in talonAmbCtr.nsi.V006.list">
                                                {[{V006.name}]}
                                            </option>
                                        </select>
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Дата начала лечения ЗС</label>
                                        
                                        <div class="input-group">
                                            <input type="text"
                                               class="form-control"
                                               placeholder="ДД.ММ.ГГГГ"
                                               data-ng-pattern="/^\d{2}\.\d{2}\.\d{4}$/"
                                               data-ngg-value="talonAmbCtr.getZlDate_1()"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.date_z_1">
                                            <div class="input-group-append">
                                                <button type="button"
                                                        class="btn btn-primary"
                                                        data-ng-click="talonAmbCtr.getZlDate_1()">
                                                    <i class="fa fa-calculator fa-fw"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Дата окончания лечения ЗС</label>
                                        <div class="input-group">
                                            <input type="text"
                                               class="form-control"
                                               placeholder="ДД.ММ.ГГГГ"
                                               data-ng-pattern="/^\d{2}\.\d{2}\.\d{4}$/"
                                               data-ngg-value="talonAmbCtr.getZlDate_2()"
                                               data-ng-class="{'bg-danger text-white border-danger': talonAmbCtr.checkDateZ2()}"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.date_z_2">
                                            <div class="input-group-append">
                                                <button type="button"
                                                        class="btn btn-primary"
                                                        data-ng-click="talonAmbCtr.getZlDate_2()">
                                                    <i class="fa fa-calculator fa-fw"></i>
                                                </button>
                                                
                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Продолжительность госп-ции ЗС</label>
                                        <div class="input-group">
                                            <input type="text"
                                               class="form-control"
                                               data-ngg-value="talonAmbCtr.getKD_Z()"
                                               data-ngg-class="talonAmbCtr.checkDiffKD_KDZ()"
                                               data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '1' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '2'"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.kd_z"
                                               title="Продолжительность госпитализации (койко-дни/пациенто-дни)">
                                            <div class="input-group-append">
                                                <button type="button"
                                                        class="btn btn-primary"
                                                        data-ng-click="talonAmbCtr.getKD_Z()"
                                                        data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '1' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '2'">
                                                    <i class="fa fa-calculator fa-fw"></i>
                                                </button>
                                            </div>
                                        </div>
                                        

                                    </div>
                                </div>

                                <div class="row pt-3">
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Вид МП</label>
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.vidpom">
                                            <option value="{[{V008.id}]}"
                                                    data-ng-repeat="V008 in talonAmbCtr.nsi.V008.list">
                                                {[{V008.name}]}
                                            </option>
                                        </select>
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Форма оказания МП</label>
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.for_pom">
                                            <option value="{[{V014.id}]}"
                                                    data-ng-repeat="V014 in talonAmbCtr.nsi.V014.list">
                                                {[{V014.name}]}
                                            </option>
                                        </select>
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">
                                            <span class="badge badge-dark">19</span>&nbsp;&nbsp;Код способа оплаты МП
                                    </label>
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.idsp">
                                            <option data-ng-value="V010.IDSP"
                                                    data-ng-repeat="V010 in talonAmbCtr.refBooks.V010">
                                                {[{V010.IDSP}]} - {[{V010.SPNAME | limitTo: 50}]} 
                                            </option>
                                        </select>
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">
                                            Тип оплаты
                                        </label>
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.oplata" disabled>
                                            <option value="0" selected>Не принято решение об оплате</option>
                                            <option value="1">Полная</option>
                                            <option value="2">Полный отказ</option>
                                            <option value="3">Частичный отказ</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="row pt-3">
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Код МО, направившей на лечение</label>
                                        <input type="text"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.npr_mo">
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Дата направления на лечение</label>
                                        <input type="text"
                                               class="form-control"
                                               placeholder="ДД.ММ.ГГГГ"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.npr_date"
                                               title="Дата направления на лечение (диагностику, консультацию, госпитализацию)">
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Признак внутбол перевода</label>
                                        <input type="text"
                                               class="form-control"
                                               data-ng-pattern="/^1?$/"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.vb_p"
                                               data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '1' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '2'"
                                               title="Указывается '1' только при оплате случая по КСГ с внутрибольничным переводом.">
                                    </div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate">Особый случай</label>
                                        <select class="form-control"
                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.os_sluch">
                                            <option value="">Нет</option>
                                            <option value="1">1 - Медицинская помощь оказана новорожденному
                                                ребенку до государственной регистрации рождения при многоплодных
                                                родах
                                            </option>
                                            <option value="2">2 - В документе, удостоверяющем личность
                                                пациента/родителя (представителя) пациента, отсутствует отчество
                                            </option>
                                        </select>
                                    </div>

                                </div>

                                <div class="row pt-3">
                                    <div class="col-12">
                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">16</span>
                                            &nbsp;&nbsp;Результат обращения
                                        </label>
                                        <div class="input-group">
                                            <input type="text"
                                                   name="patientName"
                                                   placeholder="Код"
                                                   class="form-control col-1 text-center"
                                                   data-ng-model="talonAmbCtr.filters.talonEditorModel.rmp_id">
                                            <input type="text"
                                                   name="patientName"
                                                   placeholder="Поиск названия"
                                                   class="form-control col-2 text-center"
                                                   data-ng-model="talonAmbCtr.filters.talonEditorModel.rslt">
                                            <select class="form-control"
                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.rslt">
                                                <option data-ng-value="V009.IDRMP"
                                                        data-ng-repeat="V009 in talonAmbCtr.refBooks.V009
                                                                                    | filterListField : 'DL_USLOV' : talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok">
                                                    {[{V009.IDRMP}]} - {[{V009.RMPNAME}]}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="row pt-3">
                                    <div class="col-12">
                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">18</span>
                                            &nbsp;&nbsp;Исход заболевания
                                        </label>
                                        <div class="input-group">
                                            <input type="text"
                                                   name="patientName"
                                                   placeholder="Код"
                                                   class="form-control col-1 text-center"
                                                   data-ng-model="talonAmbCtr.filters.talonEditorModel.ishod_id">
                                            <input type="text"
                                                   name="patientName"
                                                   placeholder="Поиск названия"
                                                   class="form-control col-2 text-center"
                                                   data-ng-model="talonAmbCtr.filters.talonEditorModel.ishod_name">
                                            <select class="form-control"
                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.ishod">
                                                <option data-ng-value="V012.IDIZ"
                                                        data-ng-repeat="V012 in talonAmbCtr.refBooks.V012
                                                                                    | filterListField : 'id' : talonAmbCtr.filters.talonEditorModel.ishod_id
                                                                                    | filterListField : 'DL_USLOV' : talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok">
                                                    {[{V012.IDIZ}]} - {[{V012.IZNAME}]}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row pt-3">
                                    <div class="col-9"></div>
                                    <div class="col-3">
                                        <label class="col-12 px-0 m-0 text-truncate" class="font-weight-bold">Сумма, выставленная к оплате</label>
                                        <input type="text"
                                               class="form-control font-weight-bold"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sumv">
                                    </div>
                                </div>






                                <div class="row">
                                    <div class="col-12 pt-2 pb-2">
                                        <div>
                                            <hr>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-12">
                                        <div class="card border-secondary">
                                            <div class="card-header border-bottom border-secondary">
                                                <div class="row">
                                                    <div class="col-4 pt-2 text-uppercase">
                                                        <strong>Случаи</strong>
                                                    </div>
                                                    <div class="col-2 text-right">
                                                        <button type="button"
                                                                data-target="#dontDeleteSL_Modal"
                                                                data-toggle="modal"
                                                                class="btn btn-block btn-danger">
                                                            Удалить случай
                                                        </button>
                                                    </div>
                                                    <div class="col-4">
                                                        <nav aria-label="Page navigation example">
                                                            <ul class="pagination bg-white border m-0">
                                                                <li class="page-item"
                                                                    data-ng-class="{active: $index == talonAmbCtr.slIndex}"
                                                                    data-ng-repeat="sl in talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl track by $index">
                                                                    <a href="#!" 
                                                                       class="page-link" 
                                                                       data-ng-click="talonAmbCtr.setSlIndex($index)">
                                                                        {[{$index + 1}]}
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </nav>
                                                    </div>
                                                    <div class="col-2 text-right">
                                                        <button type="button"
                                                                data-ng-click="talonAmbCtr.addSL()"
                                                                class="btn btn-block btn-primary"
                                                                data-ng-disabled="   (talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok == '1' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.vb_p != '1') 
                                                                                  || (talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok == '2' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.vb_p != '1')
                                                                                  || (talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok == '4' )">
                                                            Добавить случай
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <div class="row pb-3">
                                                    <div class="col-12">
                                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">17</span>&nbsp;&nbsp;Цель посещения</label>
                                                        <div class="input-group">
                                                            <input type="text"
                                                                   name="patientName"
                                                                   placeholder="Код"
                                                                   class="form-control col-1 text-center"
                                                                   data-ng-model="talonAmbCtr.filters.talonEditorModel.p_cel_id"
                                                                   data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '3'">
                                                            <input type="text"
                                                                   name="patientName"
                                                                   placeholder="Поиск названия"
                                                                   class="form-control col-2 text-center"
                                                                   data-ng-model="talonAmbCtr.filters.talonEditorModel.p_cel_name"
                                                                   data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '3'">
                                                            <select class="form-control"
                                                                    data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '3'"
                                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].p_cel">
                                                                <option data-ng-value="V025.id"
                                                                        data-ng-repeat="V025 in talonAmbCtr.nsi.V025.list
                                                                                                    | filterListField : 'id' : talonAmbCtr.filters.talonEditorModel.p_cel_id
                                                                                                    | filterListField : 'name' : talonAmbCtr.filters.talonEditorModel.p_cel_name">
                                                                    {[{V025.id}]} - {[{V025.name}]}
                                                                </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-2">
                                                        <label class="col-12 px-0 m-0 text-truncate">Подразделение МО</label>
                                                        <input type="text"
                                                               class="form-control"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].lpu_1"
                                                               title="Подразделение МО">
                                                    </div>
                                                    <div class="col-2">
                                                        <label class="col-12 px-0 m-0 text-truncate">Код отделения</label>
                                                        <input type="text"
                                                               class="form-control"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].podr"
                                                               title="Код отделения">
                                                    </div>
                                                    <div class="col-3">
                                                        <label class="col-12 px-0 m-0 text-truncate">Профиль медицинской помощи</label>
                                                        <select class="form-control"
                                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].profil">
                                                            <option data-ng-value="V002.IDPR"
                                                                    data-ng-repeat="V002 in talonAmbCtr.refBooks.V002">
                                                                {[{V002.IDPR}]} - {[{V002.PRNAME | limitTo: 50}]} 
                                                            </option>
                                                        </select>
                                                    </div>
                                                    <div class="col-3">
                                                        <div class="row" data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok == '1' || talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok == '2'">
                                                            <div class="col-12">
                                                                <label class="col-12 px-0 m-0 text-truncate">Профиль койки</label>
                                                                <select class="form-control"
                                                                        data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].profil_k">
                                                                    <option data-ng-value="V020.IDK_PR"
                                                                            data-ng-repeat="V020 in talonAmbCtr.refBooks.V020">
                                                                        {[{V020.IDK_PR}]} - {[{V020.K_PRNAME | limitTo: 50}]} 
                                                                    </option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="row" data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '1' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '2'">
                                                            <div class="col-12">
                                                                <label class="col-12 px-0 m-0 text-truncate">Профиль койки</label>
                                                                <select class="form-control"
                                                                        data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].profil_k" disabled>
                                                                    <option data-ng-value=null selected></option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>                             
                                                    <div class="col-2">
                                                        <label class="col-12 px-0 m-0 text-truncate">Признак детского профиля</label>
                                                        <select class="form-control"
                                                                data-ng-model="talonAmbCtr.uslEditorModel.det">
                                                            <option value=0>0 - нет</option>
                                                            <option value=1>1 - да</option>
                                                        </select>
                                                    </div>

                                                    
                                                </div>
                                                <div class="row pt-3">
                                                    <div class="col-2">
                                                        <label class="col-12 px-0 m-0 text-truncate" class="font-weight-bold">Номер истории болезни/талона АПП</label>
                                                        <input type="text"
                                                               class="form-control font-weight-bold"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].nhistory">
                                                    </div>
                                                    <div class="col-3">
                                                        <label class="col-12 px-0 m-0 text-truncate">Признак поступления/перевода</label>
                                                        <select class="form-control"
                                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].p_per"
                                                                data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '1' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '2'">
                                                            <option value="1">1 - Самостоятельно</option>
                                                            <option value="2">2 - СМИ</option>
                                                            <option value="3">3 - Перевод из другой МО</option>
                                                            <option value="4">4 - Перевод внутри МО с другого профиля</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-2">
                                                        <label class="col-12 px-0 m-0 text-truncate">Дата начала СЛ</label>
                                                        <input type="text"
                                                               class="form-control"
                                                               placeholder="ДД.ММ.ГГГГ"
                                                               data-ng-pattern="/^\d{2}\.\d{2}\.\d{4}$/"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].date_1">
                                                    </div>
                                                    <div class="col-2">
                                                        <label class="col-12 px-0 m-0 text-truncate">Дата окончания СЛ</label>
                                                        <input type="text"
                                                               class="form-control"
                                                               placeholder="ДД.ММ.ГГГГ"
                                                               data-ng-pattern="/^\d{2}\.\d{2}\.\d{4}$/"
                                                               data-ng-class="{'bg-danger text-white border-danger': talonAmbCtr.checkDate2()}"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].date_2">
                                                    </div>
                                                    <div class="col-3">
                                                        <label class="col-12 px-0 m-0 text-truncate">Продолжительность госп-ции СЛ</label>
                                                        <div class="input-group">
                                                            <input type="text"
                                                               class="form-control"
                                                               data-ngg-value="talonAmbCtr.getKD()"
                                                               data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '1' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '2'"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].kd"
                                                               title="Продолжительность госпитализации (койко-дни/пациенто-дни)">
                                                            <div class="input-group-append">
                                                                <button type="button"
                                                                        class="btn btn-primary"
                                                                        data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '1' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '2'"
                                                                        data-ng-click="talonAmbCtr.getKD()">
                                                                    <i class="fa fa-calculator fa-fw"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row pt-3">
                                                    <div class="col-4">
                                                        <label class="col-12 px-0 m-0 text-truncate"><span class="badge badge-dark">12</span>&nbsp;&nbsp;Врач (ФИО)</label>
                                                        <input type="text"
                                                               name="vpolis"
                                                               class="form-control"
                                                               data-ng-model="talonAmbCtr.talonEditorModel._doctor.name">
                                                    </div>
                                                    <div class="col-4">
                                                        <label class="col-12 px-0 m-0 text-truncate">Врач (СНИЛС)</label>
                                                        <input type="text"
                                                               name="vpolis"
                                                               class="form-control"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].iddokt">
                                                    </div>
                                                    <div class="col-4">
                                                        <label class="col-12 px-0 m-0 text-truncate">Специальность</label>
                                                        <div class="input-group">
                                                            <select class="form-control"
                                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].prvs"
                                                                    disabled>
                                                                <option data-ng-value="V021.id"
                                                                        data-ng-repeat="V021 in talonAmbCtr.nsi.V021.list">
                                                                    {[{V021.id}]} - {[{V021.name}]}
                                                                </option>
                                                            </select>
                                                            <div class="input-group-append">
                                                                <button type="button"
                                                                        class="btn btn-primary form-control"
                                                                        data-toggle="modal"
                                                                        data-target="#doctor">
                                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                                </button>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                                
                                                <div class="row pt-3">
                                                    <div class="col-3">
                                                        <label class="col-12 px-0 m-0 text-truncate">Поиск</label>
                                                        <div class="input-group">
                                                            <input type="text"
                                                                   name="patientName"
                                                                   placeholder="Код МКБ-10"
                                                                   class="form-control"
                                                                   data-ng-model="talonAmbCtr.filters.refBooksDinamic.ds0.mkb10">
                                                            <div class="input-group-append">
                                                                <button type="button"
                                                                        data-ng-click="talonAmbCtr.getMKB10('ds0')"
                                                                        class="btn btn-primary">
                                                                    <i class="fa fa-fw fa-search" aria-hidden="true"></i>      
                                                                </button>
                                                            </div>
                                                        </div>
                                                        
                                                    </div>
                                                    <div class="col-9">
                                                        <label class="col-12 px-0 m-0 text-truncate">
                                                            <span class="badge badge-dark">
                                                                {[{ talonAmbCtr.getDSLabel('ds0') }]}
                                                            </span>
                                                            &nbsp;Диагноз первичный (МКБ-10)</label>
                                                        <div class="input-group">
                                                            <select class="form-control"
                                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds0">
                                                                <option value="{[{mkb10.IDDS}]}"
                                                                        data-ng-disabled="mkb10.ALLOWED == '0' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '4'"
                                                                        data-ng-repeat="mkb10 in talonAmbCtr.refBooksDinamic.ds0.mkb10">
                                                                    {[{mkb10.IDDS}]} - {[{mkb10.DSNAME}]}
                                                                </option>
                                                            </select>
                                                            <div class="input-group-append">
                                                                <button class="btn btn-dark"
                                                                        data-ng-click="talonAmbCtr.clearDS('ds0')">
                                                                    <i class="fa fa-fw fa-times" aria-hidden="true"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>

                                                <div class="row pt-3">
                                                    <div class="col-3">
                                                        <label class="col-12 px-0 m-0 text-truncate">Поиск</label>
                                                        <div class="input-group">
                                                            <input type="text"
                                                                   name="patientName"
                                                                   placeholder="Код МКБ-10"
                                                                   class="form-control"
                                                                   data-ng-model="talonAmbCtr.filters.refBooksDinamic.ds1.mkb10">
                                                            <div class="input-group-append">
                                                                <button type="button"
                                                                        data-ng-click="talonAmbCtr.getMKB10('ds1')"
                                                                        class="btn btn-primary">
                                                                    <i class="fa fa-fw fa-search" aria-hidden="true"></i>      
                                                                </button>
                                                            </div>
                                                        </div>
                                                        
                                                    </div>
                                                    <div class="col-6">
                                                        <label class="col-12 px-0 m-0 text-truncate">
                                                            <span class="badge badge-dark">
                                                                {[{ talonAmbCtr.getDSLabel('ds1') }]}
                                                            </span>
                                                            &nbsp;Диагноз основной (МКБ-10)</label>
                                                        <div class="input-group">
                                                            <select class="form-control"
                                                                    data-ng-change="talonAmbCtr.isDS_Onk()"
                                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds1">
                                                                <option value="{[{mkb10.IDDS}]}" 
                                                                        data-ng-disabled="mkb10.ALLOWED == '0' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '4'"
                                                                        data-ng-repeat="mkb10 in talonAmbCtr.refBooksDinamic.ds1.mkb10">
                                                                    {[{mkb10.IDDS}]} - {[{mkb10.DSNAME}]}
                                                                </option>
                                                            </select>
                                                            <div class="input-group-append">
                                                                <button class="btn btn-dark"
                                                                        data-ng-click="talonAmbCtr.clearDS('ds1')">
                                                                    <i class="fa fa-fw fa-times" aria-hidden="true"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                        
                                                    </div>
                                                    <div class="col-3">
                                                        
                                                            <label class="col-12 px-0 m-0 text-truncate">Характер основного заболевания</label>
                                                            <select class="form-control"
                                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].c_zab">
                                                                <option data-ng-value="V027.IDCZ"
                                                                        data-ng-repeat="V027 in talonAmbCtr.refBooks.V027">
                                                                    {[{V027.IDCZ}]} ({[{V027.N_CZ}]}) 
                                                                </option>
                                                            </select>
                                                        
                                                    </div>

                                                </div>

                                                <div class="row pt-3">
                                                    <div class="col-3">
                                                        <label class="col-12 px-0 m-0 text-truncate">Поиск</label>
                                                        <div class="input-group">
                                                            <input type="text"
                                                                   name="patientName"
                                                                   placeholder="Код МКБ-10"
                                                                   class="form-control"
                                                                   data-ng-model="talonAmbCtr.filters.refBooksDinamic.ds2.mkb10">
                                                            <div class="input-group-append">
                                                                <button type="button"
                                                                        data-ng-click="talonAmbCtr.getMKB10('ds2')"
                                                                        class="btn btn-primary">
                                                                    <i class="fa fa-fw fa-search" aria-hidden="true"></i>      
                                                                </button>
                                                            </div>
                                                        </div>
                                                        
                                                    </div>
                                                    <div class="col-6">
                                                        <label class="col-12 px-0 m-0 text-truncate">
                                                            <span class="badge badge-dark">
                                                                {[{ talonAmbCtr.getDSLabel('ds2') }]}
                                                            </span>
                                                            &nbsp;Диагноз сопутствующего заболевания (МКБ-10)</label>
                                                        
                                                        <div class="input-group">
                                                            <select class="form-control"
                                                                    data-ng-change="talonAmbCtr.isDS_Onk()"
                                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds2">
                                                                <option value="{[{mkb10.IDDS}]}" 
                                                                        data-ng-disabled="mkb10.ALLOWED == '0' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '4'"
                                                                        data-ng-repeat="mkb10 in talonAmbCtr.refBooksDinamic.ds2.mkb10">
                                                                    {[{mkb10.IDDS}]} - {[{mkb10.DSNAME}]}
                                                                </option>
                                                            </select>
                                                            <div class="input-group-append">
                                                                <button class="btn btn-dark"
                                                                        data-ng-click="talonAmbCtr.clearDS('ds2')">
                                                                    <i class="fa fa-fw fa-times" aria-hidden="true"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-3">
                                                        
                                                            <label class="col-12 px-0 m-0 text-truncate">Признак онкологии по диагнозу (справочно)</label>
                                                            <input type="text"
                                                                   class="form-control"
                                                                   data-ng-model="talonAmbCtr.isDS_Onk_Message"
                                                                   readonly>
                                                        
                                                    </div>
                                                </div>

                                                <div class="row pt-3">
                                                    <div class="col-3">
                                                        <label class="col-12 px-0 m-0 text-truncate">Поиск</label>
                                                        <div class="input-group">
                                                            <input type="text"
                                                                   name="patientName"
                                                                   placeholder="Код МКБ-10"
                                                                   class="form-control"
                                                                   data-ng-model="talonAmbCtr.filters.refBooksDinamic.ds3.mkb10">
                                                            <div class="input-group-append">
                                                                <button type="button"
                                                                        data-ng-click="talonAmbCtr.getMKB10('ds3')"
                                                                        class="btn btn-primary">
                                                                    <i class="fa fa-fw fa-search" aria-hidden="true"></i>      
                                                                </button>
                                                            </div>
                                                        </div>
                                                        
                                                    </div>
                                                    <div class="col-6">
                                                        <label class="col-12 px-0 m-0 text-truncate">
                                                            <span class="badge badge-dark">
                                                                {[{ talonAmbCtr.getDSLabel('ds3') }]}
                                                            </span>
                                                            &nbsp;Диагноз осложнения заболевания (МКБ-10)</label>
                                                        
                                                        <div class="input-group">
                                                            <select class="form-control"
                                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds3">
                                                                <option value="{[{mkb10.IDDS}]}" 
                                                                        data-ng-disabled="mkb10.ALLOWED == '0' && talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.usl_ok != '4'"
                                                                        data-ng-repeat="mkb10 in talonAmbCtr.refBooksDinamic.ds3.mkb10">
                                                                    {[{mkb10.IDDS}]} - {[{mkb10.DSNAME}]}
                                                                </option>
                                                            </select>
                                                            <div class="input-group-append">
                                                                <button class="btn btn-dark"
                                                                        data-ng-click="talonAmbCtr.clearDS('ds3')">
                                                                    <i class="fa fa-fw fa-times" aria-hidden="true"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-3">
                                                            <label class="col-12 px-0 m-0 text-truncate">Признак реабилитации</label>
                                                            <select class="form-control"
                                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].reab">
                                                                <option value='' selected>0 - Нет</option>
                                                                <option value="1">1 - Реабилитация</option>
                                                            </select>
                                                        </div>
                                                </div>


                                                <div class="row pt-3">
                                                    <div class="col-3">
                                                        <div class="form-group m-0">
                                                            <label class="col-12 px-0 m-0 text-truncate">Признак подозрения на ЗЛ</label>
                                                            <select class="form-control"
                                                                    data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds_onk">
                                                                <option value="0">0 - При отсутствии подозрения на злокачественное новообразование</option>
                                                                <option value="1">1 - При выявлении подозрения на злокачественное новообразование</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-3"
                                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds_onk == '0'">
                                                        <label class="col-12 px-0 m-0 text-truncate">Диспансерное наблюдение</label>
                                                        <select class="form-control"
                                                                data-ng-disabled="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].p_cel != '1.3'"
                                                                data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].dn"
                                                                title="Обязательно для заполнения, если P_CEL=1.3">
                                                                <!-- <option value=null>Нет</option> -->
                                                                <option value="1">1 - состоит</option>
                                                                <option value="2">2 - взят</option>
                                                                <option value="4">4 - снят по причине выздоровления</option>
                                                                <option value="6">6 - снят по другим причинам</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-2"
                                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds_onk == '0'">
                                                        <label class="col-12 px-0 m-0 text-truncate">Тариф</label>
                                                        <input type="text"
                                                               class="form-control"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].tarif"
                                                               title="Обязательно к заполнению при DS_ONK=0">
                                                    </div>
                                                    <div class="col-2"
                                                         data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ds_onk == '0'">
                                                        <label class="col-12 px-0 m-0 text-truncate">Количество единиц оплаты МП</label>
                                                        <input type="text"
                                                               class="form-control"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ed_col"
                                                               title="Обязательно к заполнению при DS_ONK=0">
                                                    </div>
                                                    <div class="col-2">
                                                        <label class="col-12 px-0 m-0 text-truncate" class="font-weight-bold">Стоимость случая, выставленная к оплате</label>
                                                        <input type="text"
                                                               class="form-control font-weight-bold"
                                                               data-ng-change="talonAmbCtr.calcTotalSumm()"
                                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].sum_m">
                                                    </div>
                                                </div>

                                                <div class="row pt-3">
                                                    <div class="col-6"></div>
                                                    <div class="col-6">
                                                        <label class="col-12 px-0 m-0 text-truncate">Служебное поле (Заполняется в исключительных случаях)</label>
                                                        <textarea class="form-control"
                                                                  data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].comentsl"></textarea>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="card-footer">
                                                <div class="row py-2">
                                                    <div class="col-3"></div>
                                                    <div class="col-1">
                                                        <button type="button"
                                                                data-target="#ksgEditor_Modal"
                                                                data-toggle="modal"
                                                                data-ng-click="talonAmbCtr.getRefBooks(['V002', 'V021', 'V024'])"
                                                                class="btn btn-primary btn-block">
                                                            КСГ
                                                            <span class="badge badge-light"
                                                                  data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg">
                                                                0
                                                            </span>
                                                            <span class="badge badge-light"
                                                                  data-ng-if="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].ksg_kpg">
                                                                1
                                                            </span>
                                                        </button>
                                                    </div>
                                                    <div class="col-2">
                                                        <button type="button"
                                                                data-target="#consiliumEditor_Modal"
                                                                data-toggle="modal"
                                                                data-ng-click="talonAmbCtr.getRefBooks(['N019'])"
                                                                class="btn btn-primary btn-block">
                                                                Консилиум
                                                                <span class="badge "
                                                                       data-ng-class="talonAmbCtr.isConsiliumRequered()">
                                                                    {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].cons.length}]}
                                                                </span>
                                                        </button>
                                                    </div> 
                                                    <div class="col-2">
                                                        <a class="btn btn-primary btn-block"
                                                           data-toggle="modal"
                                                           data-ng-click="talonAmbCtr.getRefBooks(['N018', 'N002', 'N003', 'N004', 'N005'])"
                                                           href="#onkoEventEditor_Modal">
                                                            Онкослучай
                                                            <span class="badge "
                                                                  data-ng-class="talonAmbCtr.isOnk_SLRequered()">
                                                                {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].onk_sl.length}]}
                                                            </span>
                                                        </a>
                                                    </div>
                                                    <div class="col-2">
                                                        <a class="btn btn-primary btn-block"
                                                           data-toggle="modal"
                                                           data-ng-click="talonAmbCtr.getRefBooks(['V028', 'V029'])"
                                                           href="#orderEditor_Modal">
                                                            Направление
                                                            <span class="badge "
                                                                  data-ng-class="talonAmbCtr.isNaprRequered()">
                                                                {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].napr.length}]}
                                                            </span>
                                                        </a>
                                                    </div>
                                                    
                                                    <div class="col-2">
                                                        <button type="button"
                                                                data-target="#uslEditor_Modal"
                                                                data-toggle="modal"
                                                                data-ng-click="talonAmbCtr.getRefBooks(['V002', 'V021'])"
                                                                class="btn btn-primary btn-block">
                                                            Услуги
                                                            <span class="badge badge-light">
                                                                {[{talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].usl.length}]}
                                                            </span>
                                                        </button>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row py-3 mb-3 border-bottom">
                                    <div class="col-6"></div>                                    
                                </div>

                                <div class="row py-2 pl-4"
                                     data-ng-repeat="usluga in talonAmbCtr.talonEditorModel.listUsluga">
                                    <div class="col-2 pb-2 pl-2 border-bottom">{[{usluga.id}]}</div>
                                    <div class="col-8 pb-2 border-bottom">{[{usluga.name}]}</div>
                                    <div class="col-1 pb-2">
                                        <input type="text"
                                               class="form-control"
                                               data-ng-model="talonAmbCtr.talonEditorModel.zl_list.zap.z_sl.sl[talonAmbCtr.slIndex].usl[$index].kol_usl">
                                    </div>
                                    <div class="col-1 pb-2 ">
                                        <button type="button"
                                                class="btn btn-outline-danger btn-block"
                                                data-ng-click="talonAmbCtr.popServiseTarif($index)">
                                            <i class="fa fa-times" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                            </form>
                            <div class="row" >
                                <div class="col-12" data-ng-if="!talonAmbCtr.talonEditorModel._doctor._id">
                                    <div class="alert alert-danger" role="alert">
                                        <strong>Ошибка!</strong>&nbsp;
                                        Для сохранения данных необходимо выбрать 
                                        <a href="#doctor" data-toggle="modal" class="alert-link">Врача</a>
                                    </div>
                                </div>
                            </div>
                            <div class="row" data-ng-if="!talonAmbCtr.talonEditorModel.zl_list.schet._id">
                                <div class="col-12">
                                    <div class="alert alert-danger" role="alert">
                                        <strong>Ошибка!</strong>&nbsp;
                                        Для сохранения данных необходимо выбрать 
                                        <a href="#checkEditor_Modal" data-toggle="modal" class="alert-link">Счет</a>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3">
                                <div class="col-2 text-right">
                                    <button type="button"
                                            class="btn btn-block btn-primary"
                                            data-ng-click="talonAmbCtr.emptyTalonEditorModel()">
                                        Новый талон
                                    </button>
                                </div>
                                <div class="col-2">
                                    <a class="btn btn-outline-primary btn-block" 
                                       href="#!" 
                                       id="showTalonList">
                                        Список талонов
                                        <span class="badge badge-primary"
                                              data-ng-if="talonAmbCtr.records.length > 0">
                                            {[{talonAmbCtr.records.length}]}
                                        </span>
                                        
                                    </a>
                                    
                                </div>
                                <div class="col-6"></div>
                                <div class="col-2 text-right">
                                    <button type="button"
                                            class="btn btn-block btn-warning"
                                            data-ng-click="talonAmbCtr.recordSave()"
                                            data-ngg-disabled="!talonAmb_Form.$valid">
                                            <span data-ng-if="talonAmbCtr.talonEditorModel._id == undefined">Сохранить</span>
                                            <span data-ng-if="talonAmbCtr.talonEditorModel._id != undefined">Обновить</span>
                                        
                                    </button>
                                </div>
                            </div>
                            
                        </div>
                        <!-- Поля амбулаторного талона (базовый) -->

                        <!-- Список талонов -->
                        <div class="tab-pane fade" id="talonList">
                            <div class="row">
                                <div class="col-2">
                                    <div class="row">
                                        <div class="col-4 pt-4">
                                            <button type="button"
                                                    class="btn btn-block btn-outline-danger text-center mt-2 px-0"
                                                    data-ng-click="talonAmbCtr.apiRecords.delete()">
                                                <i class="fa fa-times" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                        <div class="col-8">
                                            <label class="col-12 px-0 m-0 text-truncate">Фамилия Пациента</label>
                                            <input type="text"
                                                name="patientName"
                                                class="form-control"
                                                placeholder="Иванов"
                                                data-ng-model="talonAmbCtr.filters.talonList._pacient.fam">
                                        </div>
                                    </div>
                                    
                                </div>
                                <div class="col-2">
                                    <label class="col-12 px-0 m-0 text-truncate">Идент Пациента</label>
                                    <input type="text"
                                           name="patientName"
                                           class="form-control"
                                           placeholder="42871569"
                                           data-ng-model="talonAmbCtr.filters.talonList._pacient.idbars">
                                </div>
                                <div class="col-2">
                                    <label class="col-12 px-0 m-0 text-truncate">СНИЛС Пациента</label>
                                    <input type="text"
                                           name="patientName"
                                           class="form-control"
                                           placeholder="000-000-000 03"
                                           data-ng-model="talonAmbCtr.filters.talonList._pacient.snils">
                                </div>
                                <div class="col-2">
                                    <label class="col-12 px-0 m-0 text-truncate">Номер ОМС Пациента</label>
                                    <input type="text"
                                           name="patientName"
                                           class="form-control"
                                           placeholder="000-000-000 03"
                                           data-ng-model="talonAmbCtr.filters.talonList._pacient.npolis">
                                </div>
                                <div class="col-1">
                                    <label class="col-12 px-0 m-0 text-truncate">Диагноз</label>
                                    <input type="text"
                                           name="patientName"
                                           class="form-control"
                                           placeholder="С34.5"
                                           data-ng-model="talonAmbCtr.filters.talonList._pacient.ds">
                                </div>
                                <div class="col-2">
                                    <label class="col-12 px-0 m-0 text-truncate">Фамилия Врача</label>
                                    <input type="text"
                                           name="patientName"
                                           class="form-control"
                                           placeholder="Петров"
                                           data-ng-model="talonAmbCtr.filters.talonList._doctor.lastname">
                                </div>
                                
                                
                                
                                <div class="col-1 pt-4 text-right">
                                    <div class="btn-group btn-block">
                                        <button type="button"
                                            data-toggle="modal"
                                            class="btn btn-block btn-secondary text-center mt-2"
                                            data-target="#dontFindCheck_Modal"
                                            data-ng-if="talonAmbCtr.talonEditorModel.zl_list.schet._id == undefined">
                                        <i class="fa fa-refresh" aria-hidden="true"></i>
                                        </button>
                                        <button type="button"
                                                class="btn btn-block btn-primary text-center mt-2"
                                                data-ng-if="talonAmbCtr.talonEditorModel.zl_list.schet._id != undefined"
                                                data-ng-click="talonAmbCtr.readRecords()">
                                            <i class="fa fa-refresh" aria-hidden="true"></i>
                                        </button>
                                        <button type="button"
                                            data-toggle="modal"
                                            id="goToSelectedUser"
                                            class="btn btn-block btn-success text-center mt-2">
                                        <i class="fa fa-user" aria-hidden="true"></i>
                                    </button>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-12 pt-2 pb-1">
                                    <div>
                                        <hr>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <div class="row pb-3" data-ng-repeat="talon in talonAmbCtr.records
                                                                                              | filterRecords : 'ds' : talonAmbCtr.filters.talonList._pacient.ds
                                                                                              | filterRecords : 'fam' : talonAmbCtr.filters.talonList._pacient.fam
                                                                                              | filterRecords : 'snils' : talonAmbCtr.filters.talonList._pacient.snils
                                                                                              | filterRecords : 'idbars' : talonAmbCtr.filters.talonList._pacient.idbars
                                                                                              | filterRecords : 'npolis' : talonAmbCtr.filters.talonList._pacient.npolis
                                                                                              | filterRecords : 'lastname' : talonAmbCtr.filters.talonList._doctor.lastname">
                                        <!-- <div class="col-1 text-center">
                                            <input type="checkbox"
                                                       data-ng-model="x"
                                                       data-ng-change="talonAmbCtr.selectTalonId(talon._id)">
                                        </div> -->
                                        <div class="col-12">
                                            <div class="mx-2 mt-3 pt-4" style="float: left;">
                                                <input type="checkbox"
                                                       data-ng-model="x"
                                                       data-ng-change="talonAmbCtr.selectTalonId(talon._id)">
                                            </div>
                                           
                                           <div id="{[{talon._id}]}"
                                                class="card talon-list-talon"  
                                                data-ng-class="{'talon-list-talon-active' : talonAmbCtr.isSelectedTalon(talon._id)}">
                                                <div class="card-body">
                                                    <div class="row" >
                                                       <div class="col-4">
                                                           <strong class="text-primary">
                                                                <a href="#!"
                                                                    data-ng-click="talonAmbCtr.toTalonEditor(talon._id)">
                                                                    {[{talon._pacient.fam}]} {[{talon._pacient.im}]} {[{talon._pacient.ot}]}
                                                                </a>
                                                            </strong> 
                                                            <div class="text-secondary">
                                                                <small>ID: {[{talon.zl_list.zap.pacient.id_pac}]}</small>&nbsp;&nbsp;
                                                                <small>ДР: {[{talon._pacient.dr}]}</small>&nbsp;&nbsp;
                                                                <small>СНИЛС: {[{talon._pacient.snils}]}</small>&nbsp;&nbsp;
                                                                <small>ОМС: {[{talon.zl_list.zap.pacient.npolis}]}</small>
                                                            </div>
                                                       </div>
                                                       <div class="col-1 pt-2">
                                                            <h5>
                                                                <span class="btn btn-dark btn-block px-0 font-weight-bold">
                                                                    {[{talon.zl_list.zap.z_sl.sl[0].ds1 || 'Нет'}]}
                                                                </span>
                                                            </h5>
                                                       </div>
                                                       <div class="col-2 pt-3">
                                                            <strong>
                                                                &nbsp;&nbsp;{[{talon.zl_list.zap.z_sl.sumv || '0.00'}]} руб.
                                                            </strong>
                                                       </div>
                                                       <div class="col-4">
                                                           <strong class="text-secondary">
                                                                {[{talon._doctor.lastname}]} {[{talon._doctor.firstname}]} {[{talon._doctor.middlename}]}
                                                            </strong>
                                                            <div class="text-secondary">
                                                                <small>
                                                                    Дата нач ЗС: <span class="text-dark font-weight-bold">{[{talon.zl_list.zap.z_sl.date_z_1 || 'Нет'}]}</span>&nbsp;&nbsp;
                                                                    Дата окн ЗС: <span class="text-dark font-weight-bold">{[{talon.zl_list.zap.z_sl.date_z_2 || 'Нет'}]}</span>
                                                                </small>
                                                            </div>
                                                       </div>
                                                       <div class="col-1 pt-2">
                                                           <a href="#!" 
                                                              data-ng-click="talonAmbCtr.cloneRecord(talon._id)"
                                                              class="btn btn-outline-primary btn-block">
                                                                   <i class="fa fa-fw fa-clone"></i>
                                                               </a>
                                                       </div>
                                                    </div>
                                                    
                                                </div>
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Список талонов -->

                        <!-- Список пациентов -->
                        <div class="tab-pane fade" id="patientList">
                            <div class="col-3 pt-4">
                                <form method="POST" action="http://10.6.0.159:8000/patient/upload" enctype="multipart/form-data">
                                    <div class="row pt-2">
                                        <div class="col-9">
                                            <div class="custom-file">
                                                <input type="file" class="custom-file-input" name="file" required id="id_file">
                                                <input type="hidden" name="lpu_num" name="lpu_num" value="{[{talonAmbCtr.lpu}]}" id="id_lpu_num">
                                                <label class="custom-file-label" for="id_file">Список пациентов</label>
                                            </div>
                                        </div>
                                        <div class="col-3">
                                            <button type="submit"
                                                    class="btn btn-block btn-primary text-center"
                                                    data-ng-click="talonAmbCtr.uploadTalons()">
                                                <i class="fa fa-download" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                    </div>        
                                </form>
                            </div>
                        </div>

                        <!-- Проверка талонов -->
                        <div class="tab-pane fade" id="validateRecords">
                            <div class="row">
                                <div class="col-12">
                                    <button type="button" class="btn btn-primary" data-ng-click="talonAmbCtr.checkRecords()">
                                        Проверить
                                    </button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    
                                </div>
                            </div>
                        </div>


                        



                    </div>
                </div>
            </div>
            <div class="row py-4">
                <div class="col-12 py-4"></div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $('#showTalonList').click(() => {
        $('a[href~="#talonList"]').tab('show');
        setTimeout(() => {
            if ($(".talon-list-talon-active").offset()) {
                window.scrollTo({top:$(".talon-list-talon-active").offset().top - 300});
            }
        }, 500);
        
    });

    $('#goToSelectedUser').click(() => {
        if ($(".talon-list-talon-active").offset()) {
            window.scrollTo({top:$(".talon-list-talon-active").offset().top - 300});
        } 
    });

    $('#toastRecord_Success').on('show.bs.toast', function () {
        $('#toastWrap').css('left', '0px');
    });

    $('#toastRecord_Success').on('hide.bs.toast', function () {
        setTimeout(function(){
            $('#toastWrap').css('left', '-260px');
        }, 1500);
    })

</script>